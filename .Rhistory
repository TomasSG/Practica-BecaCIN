geom_point() +
geom_point(aes(y = abs(d_residuos) > 2), color = "firebrick") +
geom_hline(yintercept = c(2, -2), color = "firebrick", size = 1.3, linetype = 2) +
ylab("Residuos de Deviancia") +
xlab("Valores Ajustados") +
ggtitle("Análisis de Residuos")
ggplot(df_residuos, aes(valores_ajustados, d_residuos)) +
geom_point() +
geom_hline(yintercept = c(2, -2), color = "firebrick", size = 1.3, linetype = 2) +
ylab("Residuos de Deviancia") +
xlab("Valores Ajustados") +
ggtitle("Análisis de Residuos")
df_residuos <- data.frame(d_residuos = residuals(modelo_it1, type = "deviance"),
residuos = modelo_it1$residuals,
valores_ajustados = modelo_it1$fitted.values)
ggplot(df_residuos, aes(valores_ajustados, d_residuos)) +
geom_point() +
geom_hline(yintercept = c(2, -2), color = "firebrick", size = 1.3, linetype = 2) +
ylab("Residuos de Deviancia") +
xlab("Valores Ajustados") +
ggtitle("Análisis de Residuos")
rm(df_resiudos)
df_residuos %>% select(abs(d_residuos) >= 2)
df_residuos %>% filter(abs(d_residuos) >= 2)
which(df_residuos[(abs(df_residuos$d_residuos) >= 2),])
df_residuos[(abs(df_residuos$d_residuos) >= 2),]
which((abs(df_residuos$d_residuos) >= 2))
indices <- which((abs(df_residuos$d_residuos) >= 2))
datos_it2[indices, ]
nrow(datos_it2[indices,])
rm(indices,df_residuos)
puntos_outliers <- distancia_cook = hatvalues(modelo_it1)
puntos_outliers <- hatvalues(modelo_it1)
puntos_outliers
puntos_outliers <- data.frame(leverage = hatvalues(modelo_it1))
puntos_outliers
puntos_outliers <- data.frame(leverage = hatvalues(modelo_it1)) %>% arrange(-leverage)
puntos_outliers
4/nrow(datos_it1)
4/nrow(datos_it2)
puntos_influyentes <- data.frame(ldistancia_cook = cooks.distance(modelo_it1))
puntos_influyentes <- puntos_influyentes %>% arrange(-distancia_cook)
puntos_influyentes <- data.frame(distancia_cook = cooks.distance(modelo_it1))
puntos_influyentes <- puntos_influyentes %>% arrange(-distancia_cook)
puntos_influyentes
rm(puntos_influyentes)
dats_it2[241,]
datos_it2[241,]
datos_it3 <- datos_it2[-241,]
datos_it3 <- datos_it2[-241,]
modelo_it2 <- glm(sobrevivio ~ clase + sexo + edad + precio_ticket, data = datos_it3,
family = "binomial")
summary(modelo_it2)
print("Resultados del calculo del pseudo R2")
print(calcular_pseudo_R2(modelo_it2))
puntos_influyentes <- data.frame(distancia_cook = cooks.distance(modelo_it3))
puntos_influyentes <- puntos_influyentes %>% arrange(-distancia_cook)
puntos_influyentes
puntos_influyentes <- data.frame(distancia_cook = cooks.distance(modelo_it3))
puntos_influyentes <- puntos_influyentes %>% arrange(-distancia_cook)
puntos_influyentes
rm(puntos_influyentes)
predicciones <- ifelse(modelo_it3$fitted.values >= valor_corte, "Sí", "No")
predicciones_factor <- factor(predicciones, levels = c("Sí", "No"))
observaciones_reales_factor <- factor(datos_it3$sobrevivio, levels = c(1, 0), labels = c("Sí", "No"))
matriz_confusion <- confusionMatrix(predicciones_factor, observaciones_reales_factor)
kable(matriz_confusion$table)
rm(predicciones, predicciones_factor, observaciones_reales_factor, matriz_confusion)
df_valores_corte <- obtener_resultados_todos_posibles_valores_criticos(
valores_reales = datos_it3$sobrevivio,
probabilidades_estimadas = modelo_it3$fitted.values)
df_grafico <- data.frame(valor_corte = df_valores_corte$valor_corte,
valor =df_valores_corte$sensibilidad,
curva = "Sensibilidad")
df_grafico <- rbind(df_grafico, data.frame(valor_corte = df_valores_corte$valor_corte,
valor =df_valores_corte$especificidad,
curva = "Especificidad"))
ggplot(mapping = aes(x = valor_corte)) +
geom_line(df_grafico %>% filter(curva == "Sensibilidad"), mapping =  aes(y = valor, color = curva,
linetype = curva), size = 1.3) +
geom_line(df_grafico %>% filter(curva == "Especificidad"), mapping =  aes(y = valor, color = curva,
linetype = curva), size = 1.3) +
xlab("Valor de Corte") +
ylab("") +
ggtitle("Análisis de Posibles Valores de Corte") +
scale_y_continuous(labels = label_percent()) +
scale_x_continuous(breaks = seq(0, 1, .1))
rm(df_grafico)
df_valores_corte %>% filter(abs(sensibilidad - especificidad) <= 0.01)
kable(matriz_confusion)
confusionMatrix(predicciones_factor, observaciones_reales_factor)
predicciones <- ifelse(modelo_it3$fitted.values >= valor_corte, "Sí", "No")
predicciones_factor <- factor(predicciones, levels = c("Sí", "No"))
observaciones_reales_factor <- factor(datos_it3$sobrevivio, levels = c(1, 0), labels = c("Sí", "No"))
confusionMatrix(predicciones_factor, observaciones_reales_factor)
rm(predicciones, predicciones_factor, observaciones_reales_factor, valor_corte)
View(tabla_resumen_modelos)
kable(ttabla_resumen_modelos)
kable(tabla_resumen_modelos)
install.packages("pROC")
library(proc)
library(pROC) #roc y auc
roc(datos_it2$sobrevivio, modelo_it0$fitted.values, plot = TRUE, percent = TRUE, col = "#fec44f", print.auc = TRUE)
roc0
roc0 <- roc(datos_it2$sobrevivio, modelo_it0$fitted.values, legacy.axes = TRUE, plot = TRUE,
percent = TRUE, col = "#fec44f", print.auc = TRUE)
roc1 <- roc(datos_it2$sobrevivio, modelo_it1$fitted.values, legacy.axes = TRUE, plot = TRUE,
percent = TRUE, col = "#2b8cbe", print.auc = TRUE)
roc2 <- roc(datos_it3$sobrevivio, modelo_it2$fitted.values, legacy.axes = TRUE, plot = TRUE,
percent = TRUE, col = "#31a354", print.auc = TRUE)
roc3 <- roc(datos_it3$sobrevivio, modelo_it3$fitted.values, legacy.axes = TRUE, plot = TRUE,
percent = TRUE, col = "#756bb1", print.auc = TRUE)
par(pty = "s")
roc0
roc0 <- roc(datos_it2$sobrevivio, modelo_it0$fitted.values, legacy.axes = TRUE, plot = TRUE,
percent = TRUE, col = "#fec44f", print.auc = TRUE, lwd = 2)
roc1 <- roc(datos_it2$sobrevivio, modelo_it1$fitted.values, legacy.axes = TRUE, plot = TRUE,
percent = TRUE, col = "#2b8cbe", print.auc = TRUE, lwd = 2)
roc2 <- roc(datos_it3$sobrevivio, modelo_it2$fitted.values, legacy.axes = TRUE, plot = TRUE,
percent = TRUE, col = "#31a354", print.auc = TRUE, lwd = 2)
roc3 <- roc(datos_it3$sobrevivio, modelo_it3$fitted.values, legacy.axes = TRUE, plot = TRUE,
percent = TRUE, col = "#756bb1", print.auc = TRUE, lwd = 2)
par(pty = "s")
roc0
plot.roc(roc1)
roc0 <- roc(datos_it2$sobrevivio, modelo_it0$fitted.values)
roc1 <- roc(datos_it2$sobrevivio, modelo_it1$fitted.values)
roc2 <- roc(datos_it3$sobrevivio, modelo_it2$fitted.values)
roc3 <- roc(datos_it3$sobrevivio, modelo_it3$fitted.values)
par(pty = "s")
roc(datos_it2$sobrevivio, modelo_it0$fitted.values, legacy.axes = TRUE, plot = TRUE,
percent = TRUE, col = "#fec44f", print.auc = TRUE, lwd = 2)
plot.roc(datos_it2$sobrevivio, modelo_it1$fitted.values, legacy.axes = TRUE, plot = TRUE,
percent = TRUE, col = "#2b8cbe", print.auc = TRUE, lwd = 2)
roc0 <- roc(datos_it2$sobrevivio, modelo_it0$fitted.values)
roc1 <- roc(datos_it2$sobrevivio, modelo_it1$fitted.values)
roc2 <- roc(datos_it3$sobrevivio, modelo_it2$fitted.values)
roc3 <- roc(datos_it3$sobrevivio, modelo_it3$fitted.values)
par(pty = "s")
roc(datos_it2$sobrevivio, modelo_it0$fitted.values, legacy.axes = TRUE, plot = TRUE,
percent = TRUE, col = "#fec44f", print.auc = TRUE, lwd = 2)
plot.roc(datos_it2$sobrevivio, modelo_it1$fitted.values, legacy.axes = TRUE, percent = TRUE,
col = "#2b8cbe", print.auc = TRUE, lwd = 2)
plot.roc(datos_it3$sobrevivio, modelo_it2$fitted.values, legacy.axes = TRUE, percent = TRUE,
col = "#31a354", print.auc = TRUE, lwd = 2)
plot.roc(datos_it3$sobrevivio, modelo_it3$fitted.values, legacy.axes = TRUE, percent = TRUE,
col = "#756bb1", print.auc = TRUE, lwd = 2)
roc0 <- roc(datos_it2$sobrevivio, modelo_it0$fitted.values)
roc1 <- roc(datos_it2$sobrevivio, modelo_it1$fitted.values)
roc2 <- roc(datos_it3$sobrevivio, modelo_it2$fitted.values)
roc3 <- roc(datos_it3$sobrevivio, modelo_it3$fitted.values)
par(pty = "s")
roc(datos_it2$sobrevivio, modelo_it0$fitted.values, legacy.axes = TRUE, plot = TRUE,
percent = TRUE, col = "#fec44f", print.auc = TRUE, lwd = 2)
plot.roc(datos_it2$sobrevivio, modelo_it1$fitted.values, legacy.axes = TRUE, percent = TRUE,
col = "#2b8cbe", print.auc = TRUE, lwd = 2, print.add = TRUE)
plot.roc(datos_it3$sobrevivio, modelo_it2$fitted.values, legacy.axes = TRUE, percent = TRUE,
col = "#31a354", print.auc = TRUE, lwd = 2, print.add = TRUE)
plot.roc(datos_it3$sobrevivio, modelo_it3$fitted.values, legacy.axes = TRUE, percent = TRUE,
col = "#756bb1", print.auc = TRUE, lwd = 2, print.add = TRUE)
roc0 <- roc(datos_it2$sobrevivio, modelo_it0$fitted.values)
roc1 <- roc(datos_it2$sobrevivio, modelo_it1$fitted.values)
roc2 <- roc(datos_it3$sobrevivio, modelo_it2$fitted.values)
roc3 <- roc(datos_it3$sobrevivio, modelo_it3$fitted.values)
par(pty = "s")
roc(datos_it2$sobrevivio, modelo_it0$fitted.values, legacy.axes = TRUE, plot = TRUE,
percent = TRUE, col = "#fec44f", print.auc = TRUE, lwd = 2)
plot.roc(datos_it2$sobrevivio, modelo_it1$fitted.values, legacy.axes = TRUE, percent = TRUE,
col = "#2b8cbe", print.auc = TRUE, lwd = 2, add = TRUE)
plot.roc(datos_it3$sobrevivio, modelo_it2$fitted.values, legacy.axes = TRUE, percent = TRUE,
col = "#31a354", print.auc = TRUE, lwd = 2, add = TRUE)
plot.roc(datos_it3$sobrevivio, modelo_it3$fitted.values, legacy.axes = TRUE, percent = TRUE,
col = "#756bb1", print.auc = TRUE, lwd = 2, add = TRUE)
roc0 <- roc(datos_it2$sobrevivio, modelo_it0$fitted.values)
roc1 <- roc(datos_it2$sobrevivio, modelo_it1$fitted.values)
roc2 <- roc(datos_it3$sobrevivio, modelo_it2$fitted.values)
roc3 <- roc(datos_it3$sobrevivio, modelo_it3$fitted.values)
par(pty = "s")
roc(datos_it2$sobrevivio, modelo_it0$fitted.values, legacy.axes = TRUE, plot = TRUE,
percent = TRUE, col = "#fec44f", print.auc = TRUE, lwd = 2)
plot.roc(datos_it2$sobrevivio, modelo_it1$fitted.values, legacy.axes = TRUE, percent = TRUE,
col = "#2b8cbe", print.auc = TRUE, lwd = 2, add = TRUE, auc.y = 40)
plot.roc(datos_it3$sobrevivio, modelo_it2$fitted.values, legacy.axes = TRUE, percent = TRUE,
col = "#31a354", print.auc = TRUE, lwd = 2, add = TRUE, auc.y = 30)
plot.roc(datos_it3$sobrevivio, modelo_it3$fitted.values, legacy.axes = TRUE, percent = TRUE,
col = "#756bb1", print.auc = TRUE, lwd = 2, add = TRUE, auc.y = 20)
roc0 <- roc(datos_it2$sobrevivio, modelo_it0$fitted.values)
roc1 <- roc(datos_it2$sobrevivio, modelo_it1$fitted.values)
roc2 <- roc(datos_it3$sobrevivio, modelo_it2$fitted.values)
roc3 <- roc(datos_it3$sobrevivio, modelo_it3$fitted.values)
par(pty = "s")
roc(datos_it2$sobrevivio, modelo_it0$fitted.values, legacy.axes = TRUE, plot = TRUE,
percent = TRUE, col = "#fec44f", print.auc = TRUE, lwd = 2)
plot.roc(datos_it2$sobrevivio, modelo_it1$fitted.values, legacy.axes = TRUE, percent = TRUE,
col = "#2b8cbe", print.auc = TRUE, lwd = 2, add = TRUE, auc.y = 40)
plot.roc(datos_it3$sobrevivio, modelo_it2$fitted.values, legacy.axes = TRUE, percent = TRUE,
col = "#31a354", print.auc = TRUE, lwd = 2, add = TRUE, auc.y = 30)
plot.roc(datos_it3$sobrevivio, modelo_it3$fitted.values, legacy.axes = TRUE, percent = TRUE,
col = "#756bb1", print.auc = TRUE, lwd = 2, add = TRUE, auc.y = 20)
roc0 <- roc(datos_it2$sobrevivio, modelo_it0$fitted.values)
roc1 <- roc(datos_it2$sobrevivio, modelo_it1$fitted.values)
roc2 <- roc(datos_it3$sobrevivio, modelo_it2$fitted.values)
roc3 <- roc(datos_it3$sobrevivio, modelo_it3$fitted.values)
par(pty = "s")
roc(datos_it2$sobrevivio, modelo_it0$fitted.values, legacy.axes = TRUE, plot = TRUE,
percent = TRUE, col = "#fec44f", print.auc = TRUE, lwd = 2)
plot.roc(datos_it2$sobrevivio, modelo_it1$fitted.values, legacy.axes = TRUE, percent = TRUE,
col = "#2b8cbe", print.auc = TRUE, lwd = 2, add = TRUE, print.auc.y = 40)
plot.roc(datos_it3$sobrevivio, modelo_it2$fitted.values, legacy.axes = TRUE, percent = TRUE,
col = "#31a354", print.auc = TRUE, lwd = 2, add = TRUE, print.auc.y = 30)
plot.roc(datos_it3$sobrevivio, modelo_it3$fitted.values, legacy.axes = TRUE, percent = TRUE,
col = "#756bb1", print.auc = TRUE, lwd = 2, add = TRUE, print.auc.y = 20)
?legend
roc0 <- roc(datos_it2$sobrevivio, modelo_it0$fitted.values)
roc1 <- roc(datos_it2$sobrevivio, modelo_it1$fitted.values)
roc2 <- roc(datos_it3$sobrevivio, modelo_it2$fitted.values)
roc3 <- roc(datos_it3$sobrevivio, modelo_it3$fitted.values)
par(pty = "s")
roc(datos_it2$sobrevivio, modelo_it0$fitted.values, legacy.axes = TRUE, plot = TRUE,
percent = TRUE, col = "#fec44f", print.auc = TRUE, lwd = 2)
plot.roc(datos_it2$sobrevivio, modelo_it1$fitted.values, legacy.axes = TRUE, percent = TRUE,
col = "#2b8cbe", print.auc = TRUE, lwd = 2, add = TRUE, print.auc.y = 40)
plot.roc(datos_it3$sobrevivio, modelo_it2$fitted.values, legacy.axes = TRUE, percent = TRUE,
col = "#31a354", print.auc = TRUE, lwd = 2, add = TRUE, print.auc.y = 30)
plot.roc(datos_it3$sobrevivio, modelo_it3$fitted.values, legacy.axes = TRUE, percent = TRUE,
col = "#756bb1", print.auc = TRUE, lwd = 2, add = TRUE, print.auc.y = 20)
legend("right", legend = c("Modelo 0", "Modelo 1", "Modelo 2", "Modelo 3"),
col = c("#fec44f", "#2b8cbe", "#31a354", "#756bb1"))
roc0 <- roc(datos_it2$sobrevivio, modelo_it0$fitted.values)
roc1 <- roc(datos_it2$sobrevivio, modelo_it1$fitted.values)
roc2 <- roc(datos_it3$sobrevivio, modelo_it2$fitted.values)
roc3 <- roc(datos_it3$sobrevivio, modelo_it3$fitted.values)
par(pty = "s")
roc(datos_it2$sobrevivio, modelo_it0$fitted.values, legacy.axes = TRUE, plot = TRUE,
percent = TRUE, col = "#fec44f", print.auc = TRUE, lwd = 2)
plot.roc(datos_it2$sobrevivio, modelo_it1$fitted.values, legacy.axes = TRUE, percent = TRUE,
col = "#2b8cbe", print.auc = TRUE, lwd = 2, add = TRUE, print.auc.y = 40)
plot.roc(datos_it3$sobrevivio, modelo_it2$fitted.values, legacy.axes = TRUE, percent = TRUE,
col = "#31a354", print.auc = TRUE, lwd = 2, add = TRUE, print.auc.y = 30)
plot.roc(datos_it3$sobrevivio, modelo_it3$fitted.values, legacy.axes = TRUE, percent = TRUE,
col = "#756bb1", print.auc = TRUE, lwd = 2, add = TRUE, print.auc.y = 20)
legend("right", legend = c("Modelo 0", "Modelo 1", "Modelo 2", "Modelo 3"),
col = c("#fec44f", "#2b8cbe", "#31a354", "#756bb1"))
roc0 <- roc(datos_it2$sobrevivio, modelo_it0$fitted.values)
roc1 <- roc(datos_it2$sobrevivio, modelo_it1$fitted.values)
roc2 <- roc(datos_it3$sobrevivio, modelo_it2$fitted.values)
roc3 <- roc(datos_it3$sobrevivio, modelo_it3$fitted.values)
par(pty = "s")
roc(datos_it2$sobrevivio, modelo_it0$fitted.values, legacy.axes = TRUE, plot = TRUE,
percent = TRUE, col = "#fec44f", print.auc = TRUE, lwd = 2)
plot.roc(datos_it2$sobrevivio, modelo_it1$fitted.values, legacy.axes = TRUE, percent = TRUE,
col = "#2b8cbe", print.auc = TRUE, lwd = 2, add = TRUE, print.auc.y = 40)
plot.roc(datos_it3$sobrevivio, modelo_it2$fitted.values, legacy.axes = TRUE, percent = TRUE,
col = "#31a354", print.auc = TRUE, lwd = 2, add = TRUE, print.auc.y = 30)
plot.roc(datos_it3$sobrevivio, modelo_it3$fitted.values, legacy.axes = TRUE, percent = TRUE,
col = "#756bb1", print.auc = TRUE, lwd = 2, add = TRUE, print.auc.y = 20)
legend("right", legend = c("Modelo 0", "Modelo 1", "Modelo 2", "Modelo 3"), col = c("#fec44f", "#2b8cbe", "#31a354", "#756bb1"))
roc0 <- roc(datos_it2$sobrevivio, modelo_it0$fitted.values)
roc1 <- roc(datos_it2$sobrevivio, modelo_it1$fitted.values)
roc2 <- roc(datos_it3$sobrevivio, modelo_it2$fitted.values)
roc3 <- roc(datos_it3$sobrevivio, modelo_it3$fitted.values)
par(pty = "s")
roc(datos_it2$sobrevivio, modelo_it0$fitted.values, legacy.axes = TRUE, plot = TRUE,
percent = TRUE, col = "#fec44f", print.auc = TRUE, lwd = 2)
plot.roc(datos_it2$sobrevivio, modelo_it1$fitted.values, legacy.axes = TRUE, percent = TRUE,
col = "#2b8cbe", print.auc = TRUE, lwd = 2, add = TRUE, print.auc.y = 40)
plot.roc(datos_it3$sobrevivio, modelo_it2$fitted.values, legacy.axes = TRUE, percent = TRUE,
col = "#31a354", print.auc = TRUE, lwd = 2, add = TRUE, print.auc.y = 30)
plot.roc(datos_it3$sobrevivio, modelo_it3$fitted.values, legacy.axes = TRUE, percent = TRUE,
col = "#756bb1", print.auc = TRUE, lwd = 2, add = TRUE, print.auc.y = 20)
legend("right", legend = c("Modelo 0", "Modelo 1", "Modelo 2", "Modelo 3"), color = c("#fec44f", "#2b8cbe", "#31a354", "#756bb1"))
roc0 <- roc(datos_it2$sobrevivio, modelo_it0$fitted.values)
roc1 <- roc(datos_it2$sobrevivio, modelo_it1$fitted.values)
roc2 <- roc(datos_it3$sobrevivio, modelo_it2$fitted.values)
roc3 <- roc(datos_it3$sobrevivio, modelo_it3$fitted.values)
par(pty = "s")
roc(datos_it2$sobrevivio, modelo_it0$fitted.values, legacy.axes = TRUE, plot = TRUE,
percent = TRUE, col = "#fec44f", print.auc = TRUE, lwd = 2)
plot.roc(datos_it2$sobrevivio, modelo_it1$fitted.values, legacy.axes = TRUE, percent = TRUE,
col = "#2b8cbe", print.auc = TRUE, lwd = 2, add = TRUE, print.auc.y = 40)
plot.roc(datos_it3$sobrevivio, modelo_it2$fitted.values, legacy.axes = TRUE, percent = TRUE,
col = "#31a354", print.auc = TRUE, lwd = 2, add = TRUE, print.auc.y = 30)
plot.roc(datos_it3$sobrevivio, modelo_it3$fitted.values, legacy.axes = TRUE, percent = TRUE,
col = "#756bb1", print.auc = TRUE, lwd = 2, add = TRUE, print.auc.y = 20)
legend("right", legend = c("Modelo 0", "Modelo 1", "Modelo 2", "Modelo 3"),
col = c("#fec44f", "#2b8cbe", "#31a354", "#756bb1"))
roc0 <- roc(datos_it2$sobrevivio, modelo_it0$fitted.values)
roc1 <- roc(datos_it2$sobrevivio, modelo_it1$fitted.values)
roc2 <- roc(datos_it3$sobrevivio, modelo_it2$fitted.values)
roc3 <- roc(datos_it3$sobrevivio, modelo_it3$fitted.values)
par(pty = "s")
roc(datos_it2$sobrevivio, modelo_it0$fitted.values, legacy.axes = TRUE, plot = TRUE,
percent = TRUE, col = "#fec44f", print.auc = TRUE, lwd = 2)
plot.roc(datos_it2$sobrevivio, modelo_it1$fitted.values, legacy.axes = TRUE, percent = TRUE,
col = "#2b8cbe", print.auc = TRUE, lwd = 2, add = TRUE, print.auc.y = 40)
plot.roc(datos_it3$sobrevivio, modelo_it2$fitted.values, legacy.axes = TRUE, percent = TRUE,
col = "#31a354", print.auc = TRUE, lwd = 2, add = TRUE, print.auc.y = 30)
plot.roc(datos_it3$sobrevivio, modelo_it3$fitted.values, legacy.axes = TRUE, percent = TRUE,
col = "#756bb1", print.auc = TRUE, lwd = 2, add = TRUE, print.auc.y = 20)
legend("right", legend = c("Modelo 0", "Modelo 1", "Modelo 2", "Modelo 3"),
col = c("#fec44f", "#2b8cbe", "#31a354", "#756bb1"), lwd = 1)
roc0 <- roc(datos_it2$sobrevivio, modelo_it0$fitted.values)
roc1 <- roc(datos_it2$sobrevivio, modelo_it1$fitted.values)
roc2 <- roc(datos_it3$sobrevivio, modelo_it2$fitted.values)
roc3 <- roc(datos_it3$sobrevivio, modelo_it3$fitted.values)
par(pty = "s")
roc(datos_it2$sobrevivio, modelo_it0$fitted.values, legacy.axes = TRUE, plot = TRUE,
percent = TRUE, col = "#fec44f", print.auc = TRUE, lwd = 2)
plot.roc(datos_it2$sobrevivio, modelo_it1$fitted.values, legacy.axes = TRUE, percent = TRUE,
col = "#2b8cbe", print.auc = TRUE, lwd = 2, add = TRUE, print.auc.y = 40)
plot.roc(datos_it3$sobrevivio, modelo_it2$fitted.values, legacy.axes = TRUE, percent = TRUE,
col = "#31a354", print.auc = TRUE, lwd = 2, add = TRUE, print.auc.y = 30)
plot.roc(datos_it3$sobrevivio, modelo_it3$fitted.values, legacy.axes = TRUE, percent = TRUE,
col = "#756bb1", print.auc = TRUE, lwd = 2, add = TRUE, print.auc.y = 20)
legend("right", legend = c("Modelo 0", "Modelo 1", "Modelo 2", "Modelo 3"),
col = c("#fec44f", "#2b8cbe", "#31a354", "#756bb1"), lwd = 2)
roc0 <- roc(datos_it2$sobrevivio, modelo_it0$fitted.values)
roc1 <- roc(datos_it2$sobrevivio, modelo_it1$fitted.values)
roc2 <- roc(datos_it3$sobrevivio, modelo_it2$fitted.values)
roc3 <- roc(datos_it3$sobrevivio, modelo_it3$fitted.values)
par(pty = "s")
roc(datos_it2$sobrevivio, modelo_it0$fitted.values, legacy.axes = TRUE, plot = TRUE,
percent = TRUE, col = "#fec44f", print.auc = TRUE, lwd = 2)
plot.roc(datos_it2$sobrevivio, modelo_it1$fitted.values, legacy.axes = TRUE, percent = TRUE,
col = "#2b8cbe", print.auc = TRUE, lwd = 2, add = TRUE, print.auc.y = 40)
plot.roc(datos_it3$sobrevivio, modelo_it2$fitted.values, legacy.axes = TRUE, percent = TRUE,
col = "#31a354", print.auc = TRUE, lwd = 2, add = TRUE, print.auc.y = 30)
plot.roc(datos_it3$sobrevivio, modelo_it3$fitted.values, legacy.axes = TRUE, percent = TRUE,
col = "#756bb1", print.auc = TRUE, lwd = 2, add = TRUE, print.auc.y = 20)
par(xpd = TRUE)
legend("right", legend = c("Modelo 0", "Modelo 1", "Modelo 2", "Modelo 3"),
col = c("#fec44f", "#2b8cbe", "#31a354", "#756bb1"), lwd = 2)
roc0 <- roc(datos_it2$sobrevivio, modelo_it0$fitted.values)
roc1 <- roc(datos_it2$sobrevivio, modelo_it1$fitted.values)
roc2 <- roc(datos_it3$sobrevivio, modelo_it2$fitted.values)
roc3 <- roc(datos_it3$sobrevivio, modelo_it3$fitted.values)
par(pty = "s")
roc(datos_it2$sobrevivio, modelo_it0$fitted.values, legacy.axes = TRUE, plot = TRUE,
percent = TRUE, col = "#fec44f", print.auc = TRUE, lwd = 2)
plot.roc(datos_it2$sobrevivio, modelo_it1$fitted.values, legacy.axes = TRUE, percent = TRUE,
col = "#2b8cbe", print.auc = TRUE, lwd = 2, add = TRUE, print.auc.y = 40)
plot.roc(datos_it3$sobrevivio, modelo_it2$fitted.values, legacy.axes = TRUE, percent = TRUE,
col = "#31a354", print.auc = TRUE, lwd = 2, add = TRUE, print.auc.y = 30)
plot.roc(datos_it3$sobrevivio, modelo_it3$fitted.values, legacy.axes = TRUE, percent = TRUE,
col = "#756bb1", print.auc = TRUE, lwd = 2, add = TRUE, print.auc.y = 20)
par(xpd = TRUE)
legend("topright", legend = c("Modelo 0", "Modelo 1", "Modelo 2", "Modelo 3"),
col = c("#fec44f", "#2b8cbe", "#31a354", "#756bb1"), lwd = 2)
roc0 <- roc(datos_it2$sobrevivio, modelo_it0$fitted.values)
roc1 <- roc(datos_it2$sobrevivio, modelo_it1$fitted.values)
roc2 <- roc(datos_it3$sobrevivio, modelo_it2$fitted.values)
roc3 <- roc(datos_it3$sobrevivio, modelo_it3$fitted.values)
par(pty = "s")
roc(datos_it2$sobrevivio, modelo_it0$fitted.values, legacy.axes = TRUE, plot = TRUE,
percent = TRUE, col = "#fec44f", print.auc = TRUE, lwd = 2)
plot.roc(datos_it2$sobrevivio, modelo_it1$fitted.values, legacy.axes = TRUE, percent = TRUE,
col = "#2b8cbe", print.auc = TRUE, lwd = 2, add = TRUE, print.auc.y = 40)
plot.roc(datos_it3$sobrevivio, modelo_it2$fitted.values, legacy.axes = TRUE, percent = TRUE,
col = "#31a354", print.auc = TRUE, lwd = 2, add = TRUE, print.auc.y = 30)
plot.roc(datos_it3$sobrevivio, modelo_it3$fitted.values, legacy.axes = TRUE, percent = TRUE,
col = "#756bb1", print.auc = TRUE, lwd = 2, add = TRUE, print.auc.y = 20)
par(xpd = TRUE)
legend(200, 200, legend = c("Modelo 0", "Modelo 1", "Modelo 2", "Modelo 3"),
col = c("#fec44f", "#2b8cbe", "#31a354", "#756bb1"), lwd = 2)
roc0 <- roc(datos_it2$sobrevivio, modelo_it0$fitted.values)
roc1 <- roc(datos_it2$sobrevivio, modelo_it1$fitted.values)
roc2 <- roc(datos_it3$sobrevivio, modelo_it2$fitted.values)
roc3 <- roc(datos_it3$sobrevivio, modelo_it3$fitted.values)
par(pty = "s")
roc(datos_it2$sobrevivio, modelo_it0$fitted.values, legacy.axes = TRUE, plot = TRUE,
percent = TRUE, col = "#fec44f", print.auc = TRUE, lwd = 2)
plot.roc(datos_it2$sobrevivio, modelo_it1$fitted.values, legacy.axes = TRUE, percent = TRUE,
col = "#2b8cbe", print.auc = TRUE, lwd = 2, add = TRUE, print.auc.y = 40)
plot.roc(datos_it3$sobrevivio, modelo_it2$fitted.values, legacy.axes = TRUE, percent = TRUE,
col = "#31a354", print.auc = TRUE, lwd = 2, add = TRUE, print.auc.y = 30)
plot.roc(datos_it3$sobrevivio, modelo_it3$fitted.values, legacy.axes = TRUE, percent = TRUE,
col = "#756bb1", print.auc = TRUE, lwd = 2, add = TRUE, print.auc.y = 20)
par(xpd = TRUE)
legend(101, 101, legend = c("Modelo 0", "Modelo 1", "Modelo 2", "Modelo 3"),
col = c("#fec44f", "#2b8cbe", "#31a354", "#756bb1"), lwd = 2)
roc0 <- roc(datos_it2$sobrevivio, modelo_it0$fitted.values)
roc1 <- roc(datos_it2$sobrevivio, modelo_it1$fitted.values)
roc2 <- roc(datos_it3$sobrevivio, modelo_it2$fitted.values)
roc3 <- roc(datos_it3$sobrevivio, modelo_it3$fitted.values)
par(pty = "s")
roc(datos_it2$sobrevivio, modelo_it0$fitted.values, legacy.axes = TRUE, plot = TRUE,
percent = TRUE, col = "#fec44f", print.auc = TRUE, lwd = 2)
plot.roc(datos_it2$sobrevivio, modelo_it1$fitted.values, legacy.axes = TRUE, percent = TRUE,
col = "#2b8cbe", print.auc = TRUE, lwd = 2, add = TRUE, print.auc.y = 40)
plot.roc(datos_it3$sobrevivio, modelo_it2$fitted.values, legacy.axes = TRUE, percent = TRUE,
col = "#31a354", print.auc = TRUE, lwd = 2, add = TRUE, print.auc.y = 30)
plot.roc(datos_it3$sobrevivio, modelo_it3$fitted.values, legacy.axes = TRUE, percent = TRUE,
col = "#756bb1", print.auc = TRUE, lwd = 2, add = TRUE, print.auc.y = 20)
par(xpd = TRUE)
legend(1, 1, legend = c("Modelo 0", "Modelo 1", "Modelo 2", "Modelo 3"),
col = c("#fec44f", "#2b8cbe", "#31a354", "#756bb1"), lwd = 2)
roc0 <- roc(datos_it2$sobrevivio, modelo_it0$fitted.values)
roc1 <- roc(datos_it2$sobrevivio, modelo_it1$fitted.values)
roc2 <- roc(datos_it3$sobrevivio, modelo_it2$fitted.values)
roc3 <- roc(datos_it3$sobrevivio, modelo_it3$fitted.values)
par(pty = "s")
roc(datos_it2$sobrevivio, modelo_it0$fitted.values, legacy.axes = TRUE, plot = TRUE,
percent = TRUE, col = "#fec44f", print.auc = TRUE, lwd = 2)
plot.roc(datos_it2$sobrevivio, modelo_it1$fitted.values, legacy.axes = TRUE, percent = TRUE,
col = "#2b8cbe", print.auc = TRUE, lwd = 2, add = TRUE, print.auc.y = 40)
plot.roc(datos_it3$sobrevivio, modelo_it2$fitted.values, legacy.axes = TRUE, percent = TRUE,
col = "#31a354", print.auc = TRUE, lwd = 2, add = TRUE, print.auc.y = 30)
plot.roc(datos_it3$sobrevivio, modelo_it3$fitted.values, legacy.axes = TRUE, percent = TRUE,
col = "#756bb1", print.auc = TRUE, lwd = 2, add = TRUE, print.auc.y = 20)
par(xpd = TRUE)
legend(1, 50, legend = c("Modelo 0", "Modelo 1", "Modelo 2", "Modelo 3"),
col = c("#fec44f", "#2b8cbe", "#31a354", "#756bb1"), lwd = 2)
roc0 <- roc(datos_it2$sobrevivio, modelo_it0$fitted.values)
roc1 <- roc(datos_it2$sobrevivio, modelo_it1$fitted.values)
roc2 <- roc(datos_it3$sobrevivio, modelo_it2$fitted.values)
roc3 <- roc(datos_it3$sobrevivio, modelo_it3$fitted.values)
par(pty = "s")
roc(datos_it2$sobrevivio, modelo_it0$fitted.values, legacy.axes = TRUE, plot = TRUE,
percent = TRUE, col = "#fec44f", print.auc = TRUE, lwd = 2)
plot.roc(datos_it2$sobrevivio, modelo_it1$fitted.values, legacy.axes = TRUE, percent = TRUE,
col = "#2b8cbe", print.auc = TRUE, lwd = 2, add = TRUE, print.auc.y = 40)
plot.roc(datos_it3$sobrevivio, modelo_it2$fitted.values, legacy.axes = TRUE, percent = TRUE,
col = "#31a354", print.auc = TRUE, lwd = 2, add = TRUE, print.auc.y = 30)
plot.roc(datos_it3$sobrevivio, modelo_it3$fitted.values, legacy.axes = TRUE, percent = TRUE,
col = "#756bb1", print.auc = TRUE, lwd = 2, add = TRUE, print.auc.y = 20)
par(xpd = TRUE)
legend(3, 50, legend = c("Modelo 0", "Modelo 1", "Modelo 2", "Modelo 3"),
col = c("#fec44f", "#2b8cbe", "#31a354", "#756bb1"), lwd = 2)
roc0 <- roc(datos_it2$sobrevivio, modelo_it0$fitted.values)
roc1 <- roc(datos_it2$sobrevivio, modelo_it1$fitted.values)
roc2 <- roc(datos_it3$sobrevivio, modelo_it2$fitted.values)
roc3 <- roc(datos_it3$sobrevivio, modelo_it3$fitted.values)
par(pty = "s")
roc(datos_it2$sobrevivio, modelo_it0$fitted.values, legacy.axes = TRUE, plot = TRUE,
percent = TRUE, col = "#fec44f", print.auc = TRUE, lwd = 2)
plot.roc(datos_it2$sobrevivio, modelo_it1$fitted.values, legacy.axes = TRUE, percent = TRUE,
col = "#2b8cbe", print.auc = TRUE, lwd = 2, add = TRUE, print.auc.y = 40)
plot.roc(datos_it3$sobrevivio, modelo_it2$fitted.values, legacy.axes = TRUE, percent = TRUE,
col = "#31a354", print.auc = TRUE, lwd = 2, add = TRUE, print.auc.y = 30)
plot.roc(datos_it3$sobrevivio, modelo_it3$fitted.values, legacy.axes = TRUE, percent = TRUE,
col = "#756bb1", print.auc = TRUE, lwd = 2, add = TRUE, print.auc.y = 20)
par(xpd = TRUE)
legend(5, 50, legend = c("Modelo 0", "Modelo 1", "Modelo 2", "Modelo 3"),
col = c("#fec44f", "#2b8cbe", "#31a354", "#756bb1"), lwd = 2)
roc0 <- roc(datos_it2$sobrevivio, modelo_it0$fitted.values)
roc1 <- roc(datos_it2$sobrevivio, modelo_it1$fitted.values)
roc2 <- roc(datos_it3$sobrevivio, modelo_it2$fitted.values)
roc3 <- roc(datos_it3$sobrevivio, modelo_it3$fitted.values)
par(pty = "s")
roc(datos_it2$sobrevivio, modelo_it0$fitted.values, legacy.axes = TRUE, plot = TRUE,
percent = TRUE, col = "#fec44f", print.auc = TRUE, lwd = 2)
plot.roc(datos_it2$sobrevivio, modelo_it1$fitted.values, legacy.axes = TRUE, percent = TRUE,
col = "#2b8cbe", print.auc = TRUE, lwd = 2, add = TRUE, print.auc.y = 40)
plot.roc(datos_it3$sobrevivio, modelo_it2$fitted.values, legacy.axes = TRUE, percent = TRUE,
col = "#31a354", print.auc = TRUE, lwd = 2, add = TRUE, print.auc.y = 30)
plot.roc(datos_it3$sobrevivio, modelo_it3$fitted.values, legacy.axes = TRUE, percent = TRUE,
col = "#756bb1", print.auc = TRUE, lwd = 2, add = TRUE, print.auc.y = 20)
par(xpd = TRUE)
legend(5, 50, legend = c("Modelo 0", "Modelo 1", "Modelo 2", "Modelo 3"),
col = c("#fec44f", "#2b8cbe", "#31a354", "#756bb1"), lwd = 2)
roc0 <- roc(datos_it2$sobrevivio, modelo_it0$fitted.values)
roc1 <- roc(datos_it2$sobrevivio, modelo_it1$fitted.values)
roc2 <- roc(datos_it3$sobrevivio, modelo_it2$fitted.values)
roc3 <- roc(datos_it3$sobrevivio, modelo_it3$fitted.values)
par(pty = "s")
roc(datos_it2$sobrevivio, modelo_it0$fitted.values, legacy.axes = TRUE, plot = TRUE,
percent = TRUE, col = "#fec44f", print.auc = TRUE, lwd = 2)
plot.roc(datos_it2$sobrevivio, modelo_it1$fitted.values, legacy.axes = TRUE, percent = TRUE,
col = "#2b8cbe", print.auc = TRUE, lwd = 2, add = TRUE, print.auc.y = 40)
plot.roc(datos_it3$sobrevivio, modelo_it2$fitted.values, legacy.axes = TRUE, percent = TRUE,
col = "#31a354", print.auc = TRUE, lwd = 2, add = TRUE, print.auc.y = 30)
plot.roc(datos_it3$sobrevivio, modelo_it3$fitted.values, legacy.axes = TRUE, percent = TRUE,
col = "#756bb1", print.auc = TRUE, lwd = 2, add = TRUE, print.auc.y = 20)
par(xpd = TRUE)
legend(-10, 50, legend = c("Modelo 0", "Modelo 1", "Modelo 2", "Modelo 3"),
col = c("#fec44f", "#2b8cbe", "#31a354", "#756bb1"), lwd = 2)
tabla_resumen_modelos <- mutate(AUC = c(auc(roc0), auc(roc1), auc(roc2), auc(roc3)))
tabla_resumen_modelos <- tabla_resumen_modelos %>% mutate(AUC = c(auc(roc0), auc(roc1), auc(roc2), auc(roc3)))
tabla_resumen_modelos <- tabla_resumen_modelos %>%
mutate(AUC = c(auc(roc0), auc(roc1), auc(roc2), auc(roc3)))
library(dplyr)
library(ggplot2)
library(ggpubr)
library(caret) #confusionMatrix
library(car) #vif
library(ggthemes)
library(scales)
library(extrafont)
library(knitr)
library(purrr)
library(pROC) #roc y auc
tabla_resumen_modelos <- tabla_resumen_modelos %>%
mutate(AUC = c(auc(roc0), auc(roc1), auc(roc2), auc(roc3)))
kable(tabla_resumen_modelos)
rm(roc0, roc1, roc2, roc3, tabla_resumen_modelos)
roc0 <- roc(datos_it2$sobrevivio, modelo_it0$fitted.values)
roc1 <- roc(datos_it2$sobrevivio, modelo_it1$fitted.values)
roc2 <- roc(datos_it3$sobrevivio, modelo_it2$fitted.values)
roc3 <- roc(datos_it3$sobrevivio, modelo_it3$fitted.values)
par(pty = "s")
roc(datos_it2$sobrevivio, modelo_it0$fitted.values, legacy.axes = TRUE, plot = TRUE,
percent = TRUE, col = "#fec44f", print.auc = TRUE, lwd = 2)
plot.roc(datos_it2$sobrevivio, modelo_it1$fitted.values, legacy.axes = TRUE, percent = TRUE,
col = "#2b8cbe", print.auc = TRUE, lwd = 2, add = TRUE, print.auc.y = 40)
plot.roc(datos_it3$sobrevivio, modelo_it2$fitted.values, legacy.axes = TRUE, percent = TRUE,
col = "#31a354", print.auc = TRUE, lwd = 2, add = TRUE, print.auc.y = 30)
plot.roc(datos_it3$sobrevivio, modelo_it3$fitted.values, legacy.axes = TRUE, percent = TRUE,
col = "#756bb1", print.auc = TRUE, lwd = 2, add = TRUE, print.auc.y = 20)
par(xpd = TRUE)
legend(-3, 50, legend = c("Modelo 0", "Modelo 1", "Modelo 2", "Modelo 3"),
col = c("#fec44f", "#2b8cbe", "#31a354", "#756bb1"), lwd = 2)
par(pty = "m")
