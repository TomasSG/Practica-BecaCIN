hacer_histograma <- function(variable, color) {
ggplot(Cars93, aes(Cars93[[variable]])) +
geom_histogram(fill = "white", color = color, bins = 15) +
theme_gdocs() +
theme(plot.title = element_text(hjust = 0.5)) +
ylab("") +
ggtitle("Histograma") +
xlab(toupper(variable))
}
g1 <- hacer_histograma("Weight", "darkred")
g2 <- hacer_histograma("Horsepower", "blue")
grid.arrange(g1, g2, nrow = 1)
hacer_histograma <- function(variable, color) {
ggplot(Cars93, aes(Cars93[[variable]])) +
geom_histogram(fill = "white", color = color, bins = 15) +
theme_gdocs() +
theme(plot.title = element_text(hjust = 0.5)) +
ylab("") +
ggtitle("Histograma") +
xlab(toupper(variable))
}
g1 <- hacer_histograma("Weight", "darkred")
g2 <- hacer_histograma("Horsepower", "blue")
grid.arrange(g1, g2, nrow = 1)
de Weight no se podría decir lo
# mismo. Vamos a hacer un qqplot para seguir analizando la normalidad
s(Wieight)) +
geom_qq_line()
ggplot(Cars93, aes(Wieight)) +
geom_qq_line()
ggplot(Cars93, aes(Weight)) +
geom_qq_line()
ggplot(Cars93, aes(sample = Weight)) +
geom_qq_line()
ggplot(Cars93, aes(sample = Weight)) +
geom_qq()
ggplot(Cars93, aes(sample = Weight)) +
geom_qq()
ggplot(Cars93, aes(sample = Weight)) +
geom_qq(color = "darkred")
ggplot(Cars93, aes(sample = Weight)) +
geom_qq(color = "darkred") +
geom_qq_line()
ggplot(Cars93, aes(sample = Weight)) +
geom_qq(color = "darkred") +
geom_qq_line() +
theme_gdocs()
ggplot(Cars93, aes(sample = Weight)) +
geom_qq(color = "darkred") +
geom_qq_line() +
theme_gdocs() +
ggtitle("QQplot")
ggplot(Cars93, aes(sample = Weight)) +
geom_qq(color = "darkred") +
geom_qq_line() +
theme_gdocs() +
ggtitle("QQplot") +
theme() +
theme(plot.title = element_text(hjust = 0.5))
ggplot(Cars93, aes(sample = Cars93[[variable]])) +
geom_qq(color = variable) +
geom_qq_line() +
theme_gdocs() +
ggtitle("QQplot") +
theme() +
theme(plot.title = element_text(hjust = 0.5))
hacer_qqplot <- function(variable, color){
ggplot(Cars93, aes(sample = Cars93[[variable]])) +
geom_qq(color = variable) +
geom_qq_line() +
theme_gdocs() +
ggtitle("QQplot") +
theme() +
theme(plot.title = element_text(hjust = 0.5))
}
g1 <- hacer_qqplot("Weight", "darkred")
g2 <- hacer_qqplot("Horsepower", "blue")
grid.arrange(g1, g2, nrow = 1)
hacer_qqplot <- function(variable, color){
ggplot(Cars93, aes(sample = .data[[variable]])) +
geom_qq(color = variable) +
geom_qq_line() +
theme_gdocs() +
ggtitle("QQplot") +
theme() +
theme(plot.title = element_text(hjust = 0.5))
}
g1 <- hacer_qqplot("Weight", "darkred")
g2 <- hacer_qqplot("Horsepower", "blue")
grid.arrange(g1, g2, nrow = 1)
g2 <- hacer_qqplot("Horsepower", "blue")
g2
ggplot(data = Cars93, aes(sample = .data[[variable]])) +
geom_qq(color = variable) +
geom_qq_line() +
theme_gdocs() +
ggtitle("QQplot") +
theme() +
theme(plot.title = element_text(hjust = 0.5))
hacer_qqplot <- function(variable, color){
ggplot(data = Cars93, aes(sample = .data[[variable]])) +
geom_qq(color = variable) +
geom_qq_line() +
theme_gdocs() +
ggtitle("QQplot") +
theme() +
theme(plot.title = element_text(hjust = 0.5))
}
g1 <- hacer_qqplot("Weight", "darkred")
g1
hacer_qqplot <- function(variable, color){
ggplot(data = Cars93, aes_string(sample = variable)) +
geom_qq(color = variable) +
geom_qq_line() +
theme_gdocs() +
ggtitle("QQplot") +
theme() +
theme(plot.title = element_text(hjust = 0.5))
}
g1 <- hacer_qqplot("Weight", "darkred")
g2 <- hacer_qqplot("Horsepower", "blue")
grid.arrange(g1, g2, nrow = 1)
hacer_qqplot <- function(variable, color){
ggplot(Cars93, aes_string(sample = variable)) +
geom_qq(color = variable) +
geom_qq_line() +
theme_gdocs() +
ggtitle("QQplot") +
theme() +
theme(plot.title = element_text(hjust = 0.5))
}
g1 <- hacer_qqplot("Weight", "darkred")
g1
?aes_string
hacer_qqplot <- function(variable, color){
ggplot(Cars93, aes_(sample = variable)) +
geom_qq(color = variable) +
geom_qq_line() +
theme_gdocs() +
ggtitle("QQplot") +
theme() +
theme(plot.title = element_text(hjust = 0.5))
}
g1 <- hacer_qqplot("Weight", "darkred")
g2 <- hacer_qqplot("Horsepower", "blue")
grid.arrange(g1, g2, nrow = 1)
?aes_string
hacer_qqplot <- function(nombre_var, color){
ggplot(Cars93, aes_(sample = quote(nombre_var))) +
geom_qq(color = nombre_var) +
geom_qq_line() +
theme_gdocs() +
ggtitle("QQplot") +
theme() +
theme(plot.title = element_text(hjust = 0.5))
}
g1 <- hacer_qqplot("Weight", "darkred")
g2 <- hacer_qqplot("Horsepower", "blue")
grid.arrange(g1, g2, nrow = 1)
hacer_qqplot <- function(nombre_var, color){
ggplot(Cars93, aes_(sample = nombre_var)) +
geom_qq(color = nombre_var) +
geom_qq_line() +
theme_gdocs() +
ggtitle("QQplot") +
theme() +
theme(plot.title = element_text(hjust = 0.5))
}
g1 <- hacer_qqplot("Weight", "darkred")
g
g1
?aes_string
?geom_qq_line
hacer_histograma <- function(nombre_var, color) {
ggplot(Cars93, aes_(nombre_var)) +
geom_histogram(fill = "white", color = color, bins = 15) +
theme_gdocs() +
theme(plot.title = element_text(hjust = 0.5)) +
ylab("") +
ggtitle("Histograma") +
xlab(toupper(nombre_var))
}
g1 <- hacer_histograma("Weight", "darkred")
g2 <- hacer_histograma("Horsepower", "blue")
grid.arrange(g1, g2, nrow = 1)
hacer_histograma <- function(nombre_var, color) {
ggplot(Cars93, aes_string(nombre_var)) +
geom_histogram(fill = "white", color = color, bins = 15) +
theme_gdocs() +
theme(plot.title = element_text(hjust = 0.5)) +
ylab("") +
ggtitle("Histograma") +
xlab(toupper(nombre_var))
}
g1 <- hacer_histograma("Weight", "darkred")
g2 <- hacer_histograma("Horsepower", "blue")
grid.arrange(g1, g2, nrow = 1)
hacer_histograma <- function(nombre_var, color) {
ggplot(Cars93, aes_(nombre_var)) +
geom_histogram(fill = "white", color = color, bins = 15) +
theme_gdocs() +
theme(plot.title = element_text(hjust = 0.5)) +
ylab("") +
ggtitle("Histograma") +
xlab(toupper(nombre_var))
}
g1 <- hacer_histograma("Weight", "darkred")
g2 <- hacer_histograma("Horsepower", "blue")
grid.arrange(g1, g2, nrow = 1)
hacer_histograma <- function(nombre_var, color) {
ggplot(Cars93, aes_(nombre_var)) +
geom_histogram(fill = "white", color = color, bins = 15) +
theme_gdocs() +
theme(plot.title = element_text(hjust = 0.5)) +
ylab("") +
ggtitle("Histograma") +
xlab(toupper(nombre_var))
}
g1 <- hacer_histograma("Weight", "darkred")
g2 <- hacer_histograma("Horsepower", "blue")
grid.arrange(g1, g2, nrow = 1)
g1 <- hacer_histograma("Weight", "darkred")
g2 <- hacer_histograma("Horsepower", "blue")
grid.arrange(g1, g2, nrow = 1)
hacer_histograma <- function(nombre_var, color) {
ggplot(Cars93, aes_string(nombre_var)) +
geom_histogram(fill = "white", color = color, bins = 15) +
theme_gdocs() +
theme(plot.title = element_text(hjust = 0.5)) +
ylab("") +
ggtitle("Histograma") +
xlab(toupper(nombre_var))
}
g1 <- hacer_histograma("Weight", "darkred")
g2 <- hacer_histograma("Horsepower", "blue")
grid.arrange(g1, g2, nrow = 1)
hacer_qqplot <- function(nombre_var, color){
ggplot(Cars93, aes_string(sample = nombre_var)) +
geom_qq(color = nombre_var) +
geom_qq_line() +
theme_gdocs() +
ggtitle("QQplot") +
theme() +
theme(plot.title = element_text(hjust = 0.5))
}
g1 <- hacer_qqplot("Weight", "darkred")
g2 <- hacer_qqplot("Horsepower", "blue")
grid.arrange(g1, g2, nrow = 1)
hacer_qqplot <- function(nombre_var, color){
ggplot(Cars93, aes_string(sample = nombre_var)) +
geom_qq(color = color) +
geom_qq_line() +
theme_gdocs() +
ggtitle("QQplot") +
theme() +
theme(plot.title = element_text(hjust = 0.5))
}
g1 <- hacer_qqplot("Weight", "darkred")
g2 <- hacer_qqplot("Horsepower", "blue")
grid.arrange(g1, g2, nrow = 1)
hacer_qqplot <- function(nombre_var, color){
ggplot(Cars93, aes_string(sample = nombre_var)) +
geom_qq(color = color) +
geom_qq_line() +
theme_gdocs() +
ggtitle(paste("QQplot", toupper(nombre_var))) +
theme() +
theme(plot.title = element_text(hjust = 0.5))
}
g1 <- hacer_qqplot("Weight", "darkred")
g2 <- hacer_qqplot("Horsepower", "blue")
grid.arrange(g1, g2, nrow = 1)
g1 <- hacer_histograma("Weight", "darkred")
g2 <- hacer_histograma("Horsepower", "blue")
grid.arrange(g1, g2, nrow = 1)
hacer_qqplot <- function(nombre_var, color){
ggplot(Cars93, aes_string(sample = nombre_var)) +
geom_qq(color = color) +
geom_qq_line() +
theme_gdocs() +
ggtitle(paste("QQplot", toupper(nombre_var))) +
theme() +
theme(plot.title = element_text(hjust = 0.5))
}
g1 <- hacer_qqplot("Weight", "darkred")
g2 <- hacer_qqplot("Horsepower", "blue")
grid.arrange(g1, g2, nrow = 1)
hacer_histograma <- function(nombre_var, color, nbins = 30) {
ggplot(Cars93, aes_string(nombre_var)) +
geom_histogram(fill = "white", color = color, bins = nbins) +
theme_gdocs() +
theme(plot.title = element_text(hjust = 0.5)) +
ylab("") +
ggtitle("Histograma") +
xlab(toupper(nombre_var))
}
g1 <- hacer_histograma("Weight", "darkred", 15)
g2 <- hacer_histograma("Horsepower", "blue", 10)
grid.arrange(g1, g2, nrow = 1)
hacer_histograma <- function(nombre_var, color, nbins = 30) {
ggplot(Cars93, aes_string(nombre_var)) +
geom_histogram(fill = "white", color = color, bins = nbins) +
theme_gdocs() +
theme(plot.title = element_text(hjust = 0.5)) +
ylab("") +
ggtitle(paste("Histograma (bins = ",nbins, ")")) +
xlab(toupper(nombre_var))
}
g1 <- hacer_histograma("Weight", "darkred", 15)
g2 <- hacer_histograma("Horsepower", "blue", 10)
grid.arrange(g1, g2, nrow = 1)
g1 <- hacer_histograma("Weight", "darkred", 25)
g2 <- hacer_histograma("Horsepower", "blue", 10)
grid.arrange(g1, g2, nrow = 1)
g1 <- hacer_histograma("Weight", "darkred", 10)
g2 <- hacer_histograma("Horsepower", "blue", 10)
grid.arrange(g1, g2, nrow = 1)
g1 <- hacer_qqplot("Weight", "darkred")
g2 <- hacer_qqplot("Horsepower", "blue")
grid.arrange(g1, g2, nrow = 1)
hacer_qqplot <- function(nombre_var, color){
ggplot(Cars93, aes_string(sample = nombre_var)) +
geom_qq(color = color) +
geom_qq_line() +
theme_gdocs() +
ggtitle(paste("QQplot", toupper(nombre_var)), color = "black") +
theme() +
theme(plot.title = element_text(hjust = 0.5))
}
g1 <- hacer_qqplot("Weight", "darkred")
g2 <- hacer_qqplot("Horsepower", "blue")
grid.arrange(g1, g2, nrow = 1)
hacer_qqplot <- function(nombre_var, color){
ggplot(Cars93, aes_string(sample = nombre_var)) +
geom_qq(color = color) +
geom_qq_line() +
theme_gdocs() +
ggtitle(paste("QQplot", toupper(nombre_var))) +
theme() +
theme(plot.title = element_text(hjust = 0.5))
}
g1 <- hacer_qqplot("Weight", "darkred")
g2 <- hacer_qqplot("Horsepower", "blue")
grid.arrange(g1, g2, nrow = 1)
shapiro.test(Cars93$Weight)
shapiro.test(Cars93$Horsepower)
Cars93 <- data.frame(Cars93, "Log_horsepower" = log10(Cars93$Horsepower))
g1 <- hacer_histograma("Log_horsepower", "blue", 10)
g2 <- hacer_qqplot("Log_horsepower", "blue")
grid.arrange(g1, g2, nrow = 1)
shapiro.test(Cars93$Log_horsepower)
cor(Cars93$Weight, Cars93$Log_horsepower, method = "pearson")
cor.test(Cars93$Weight, Cars93$Log_horsepower, method = "pearson", alternative = "two.sided", conf.level =  .95)
rstudent
?rstudent
resultados <- data.frame(resultados, "s_residuos" = rstudent(modelo))
source('C:/Users/tomas/OneDrive/Escritorio/ProyectosR/exer/PracticaInvestigacion/R/EjemploRegresionLinealSimple.R', encoding = 'UTF-8', echo=TRUE)
resultados
ggplot(resultados, aes(predicciones, abs(s_residuos))) +
geom_point() +
geom_hline(yintercept = 3)
ggplot(resultados, aes(predicciones, abs(s_residuos))) +
geom_point(color = ifelse(abs(s_residuos) > 3, "firebrick", "black")) +
geom_hline(yintercept = 3)
ggplot(resultados, aes(predicciones, abs(s_residuos))) +
geom_point(aes(color = ifelse(abs(s_residuos) > 3, "firebrick", "black"))) +
geom_hline(yintercept = 3)
ggplot(resultados, aes(predicciones, abs(s_residuos))) +
geom_point(aes(color = ifelse(abs(s_residuos) > 3, "firebrick", "black"))) +
geom_hline(yintercept = 3) +
theme_gdocs() +
ylab("Residuos studentized (valor absoluto)") +
xlab("Predicciones") +
ggtitle("Búsqueda de outliers") +
theme(plot.title = element_text(hjust = .5, size = 15))
ggplot(resultados, aes(predicciones, abs(s_residuos))) +
geom_point(aes(color = ifelse(abs(s_residuos) > 3, "firebrick", "black"))) +
geom_hline(yintercept = 3, color = "grey", linetype = "dashed") +
theme_gdocs() +
scale_color_identity() +
ylab("Residuos studentized (valor absoluto)") +
xlab("Predicciones") +
ggtitle("Búsqueda de outliers") +
theme(plot.title = element_text(hjust = .5, size = 15, color = "black"))
ggplot(resultados, aes(predicciones, abs(s_residuos))) +
geom_point(aes(color = ifelse(abs(s_residuos) > 3, "firebrick", "black"))) +
geom_hline(yintercept = 3, color = "black", linetype = "dashed") +
theme_gdocs() +
scale_color_identity() +
ylab("Residuos studentized (valor absoluto)") +
xlab("Predicciones") +
ggtitle("Búsqueda de outliers") +
theme(plot.title = element_text(hjust = .5, size = 15, color = "black"))
which(abs(resultados$s_residuos) > 3)
index_outliers <- which(abs(resultados$s_residuos) > 3)
index_outliers
library(cars, warn.conflicts = FALSE)
library(car, warn.conflicts = FALSE)
install.packages("car")
library(car, warn.conflicts = FALSE)
summary(influence.measures(modelo))
qweibull()
summary(influence.measures(modelo))
index_outliers <- which(abs(resultados$s_residuos) > 3)
index_outliers
influencePlot(modelo)
summary(influence.measures(modelo))
influencePlot(modelo)
ggplot(Cars93, aes(Log_horsepower, Weight)) +
geom_point(color = "darkblue") +
geom_smooth(method = "lm", color = "firebrick") +
theme_gdocs() +
ggtitle("Weigth ~ log10(Horsepower)") +
xlab("log10(Horsepower)") +
theme(plot.title = element_text(hjust = .5, color = "black"),
axis.title.x = element_text(color = "black"),
axis.title.y = element_text(color = "black"))
ggplot(Cars93, aes(Log_horsepower, Weight)) +
geom_point(color = "grey") +
geom_smooth(method = "lm", se = FALSE, color = "firebrick") +
geom_smooth(Cars93[,-c(39, 19)]method = "lm", se = FALSE, color = "firebrick") +
theme_gdocs() +
ggtitle("Weigth ~ log10(Horsepower)") +
xlab("log10(Horsepower)") +
theme(plot.title = element_text(hjust = .5, color = "black"),
axis.title.x = element_text(color = "black"),
axis.title.y = element_text(color = "black"))
ggplot(Cars93, aes(Log_horsepower, Weight)) +
geom_point(color = "grey") +
geom_smooth(method = "lm", se = FALSE, color = "firebrick") +
geom_smooth(Cars93[,-c(39, 19)], method = "lm", se = FALSE, color = "firebrick") +
theme_gdocs() +
ggtitle("Weigth ~ log10(Horsepower)") +
xlab("log10(Horsepower)") +
theme(plot.title = element_text(hjust = .5, color = "black"),
axis.title.x = element_text(color = "black"),
axis.title.y = element_text(color = "black"))
ggplot(Cars93, aes(Log_horsepower, Weight)) +
geom_point(color = "grey") +
geom_smooth(method = "lm", se = FALSE, color = "firebrick") +
geom_smooth(Cars93[-c(39, 19),], method = "lm", se = FALSE, color = "firebrick") +
theme_gdocs() +
ggtitle("Weigth ~ log10(Horsepower)") +
xlab("log10(Horsepower)") +
theme(plot.title = element_text(hjust = .5, color = "black"),
axis.title.x = element_text(color = "black"),
axis.title.y = element_text(color = "black"))
ggplot(Cars93, aes(Log_horsepower, Weight)) +
geom_point(color = "grey") +
geom_smooth(method = "lm", se = FALSE, color = "firebrick") +
geom_smooth(datos = Cars93[-c(39, 19),], method = "lm", se = FALSE, color = "firebrick") +
theme_gdocs() +
ggtitle("Weigth ~ log10(Horsepower)") +
xlab("log10(Horsepower)") +
theme(plot.title = element_text(hjust = .5, color = "black"),
axis.title.x = element_text(color = "black"),
axis.title.y = element_text(color = "black"))
ggplot(Cars93, aes(Log_horsepower, Weight)) +
geom_point(color = "grey") +
geom_smooth(method = "lm", se = FALSE, color = "firebrick") +
geom_smooth(data = Cars93[-c(39, 19),], method = "lm", se = FALSE, color = "firebrick") +
theme_gdocs() +
ggtitle("Weigth ~ log10(Horsepower)") +
xlab("log10(Horsepower)") +
theme(plot.title = element_text(hjust = .5, color = "black"),
axis.title.x = element_text(color = "black"),
axis.title.y = element_text(color = "black"))
ggplot(Cars93, aes(Log_horsepower, Weight)) +
geom_point(color = "grey") +
geom_smooth(method = "lm", se = FALSE, color = "firebrick") +
geom_smooth(data = Cars93[-c(39, 19),], method = "lm", se = FALSE, color = "darkblue") +
theme_gdocs() +
ggtitle("Weigth ~ log10(Horsepower)") +
xlab("log10(Horsepower)") +
theme(plot.title = element_text(hjust = .5, color = "black"),
axis.title.x = element_text(color = "black"),
axis.title.y = element_text(color = "black"))
ggplot(Cars93, aes(Log_horsepower, Weight)) +
geom_point(color = "grey") +
geom_smooth(method = "lm", se = FALSE, color = "firebrick") +
geom_point(data = Cars93[-c(39, 19),], color = "red", size = 3)
ggplot(Cars93, aes(Log_horsepower, Weight)) +
geom_point(color = "grey") +
geom_smooth(method = "lm", se = FALSE, color = "firebrick") +
geom_point(data = Cars93[c(39, 19),], color = "red", size = 2)
ggplot(Cars93, aes(Log_horsepower, Weight)) +
geom_point(color = "grey") +
geom_smooth(method = "lm", se = FALSE, color = "firebrick") +
geom_point(data = Cars93[c(39, 19),], color = "red", size = 2) +
geom_smooth(data = Cars93[-c(39, 19),], method = "lm", se = FALSE, color = "darkblue") +
theme_gdocs() +
ggtitle("Weigth ~ log10(Horsepower)") +
xlab("log10(Horsepower)") +
theme(plot.title = element_text(hjust = .5, color = "black"),
axis.title.x = element_text(color = "black"),
axis.title.y = element_text(color = "black"))
ggplot(Cars93, aes(Log_horsepower, Weight)) +
geom_point(color = "grey") +
geom_smooth(method = "lm", se = FALSE, color = "firebrick") +
geom_point(data = Cars93[c(39, 19),], color = "black", size = 2) +
geom_smooth(data = Cars93[-c(39, 19),], method = "lm", se = FALSE, color = "darkblue") +
theme_gdocs() +
ggtitle("Weigth ~ log10(Horsepower)") +
xlab("log10(Horsepower)") +
theme(plot.title = element_text(hjust = .5, color = "black"),
axis.title.x = element_text(color = "black"),
axis.title.y = element_text(color = "black"))
lm(Weight ~ Log_horsepower, Cars93[-c(39, 19),])
summary(lm(Weight ~ Log_horsepower, Cars93[-c(39, 19),]))
summary(modelo)
lm(Weight ~ Log_horsepower, Cars93[-c(39, 19),])$coefficients
modelo$coefficients
