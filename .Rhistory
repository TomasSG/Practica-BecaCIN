ylab("Precio Ticket") +
scale_y_continuous(labels = label_number(prefix = "$"))
g2 <- g0 + geom_boxplot(aes(y = edad)) +
ylab("Edad")
arrange <- ggarrange(g1, g2, nrow = 1, ncol = 2, common.legend = TRUE, legend = "bottom")
annotate_figure(arrange,
top = text_grob("Variables Cuantitativas vs Sobrevivio", face = "bold", size = 20,
family = "Dubai Medium", hjust = .5))
g1 + coord_cartesian(ylim = c(0, 100)) +
ggtitle("Precio Ticket vs Sobrevivió (con zoom)") +
theme(legend.position =  "none") +
xlab("Sobrevivió")
kable(table(datos_it1$sobrevivio, datos_it1$clase))
kable(table(datos_it1$sobrevivio, datos_it1$sexo))
kable(table(datos_grafico$sobrevivio, datos_grafico$clase))
kable(table(datos_grafico$sobrevivio, datos_grafico$sexo))
g1 <- hacer_barplot_con_dos_cuantitativas(datos_it1, "clase", "sobrevivio", max = .7) +
xlab("Clase")
g2 <- hacer_barplot_con_dos_cuantitativas(datos_it1, "sexo", "sobrevivio", max = .8) +
xlab("Sexo")
arrange <- ggarrange(g1, g2, nrow = 1, ncol = 2, common.legend = TRUE, legend = "bottom")
annotate_figure(arrange,
top = text_grob("Análisis Sobrevivió vs Cualitativas", face = "bold", size = 20,
family = "Dubai Medium", hjust = .5))
g1 <- hacer_barplot_con_dos_cuantitativas(datos_grafico, "clase", "sobrevivio", max = .7) +
xlab("Clase")
g2 <- hacer_barplot_con_dos_cuantitativas(datos_grafico, "sexo", "sobrevivio", max = .8) +
xlab("Sexo")
arrange <- ggarrange(g1, g2, nrow = 1, ncol = 2, common.legend = TRUE, legend = "bottom")
annotate_figure(arrange,
top = text_grob("Análisis Sobrevivió vs Cualitativas", face = "bold", size = 20,
family = "Dubai Medium", hjust = .5))
levels(datos_it2$sobrevivio)
modelo_it0 <- glm(sobrevivio ~ clase + sexo + edad + precio_ticket, data = datos_it2,
family = "binomial")
summary(modelo_it0)
print("Resultados del calculo del pseudo R2")
print(calcular_pseudo_R2(modelo_it0))
step(modelo_it0, direction = "both")
modelo_it1 <- glm(sobrevivio ~ clase + sexo + edad, data = datos_grafico,
family = "binomial")
summary(modelo_it1)
print("Resultados del calculo del pseudo R2")
print(calcular_pseudo_R2(modelo_it1))
modelo_it0 <- glm(sobrevivio ~ clase + sexo + edad + precio_ticket, data = datos_it2,
family = "binomial")
summary(modelo_it0)
tabla_resumen_modelos <- data.frame(Modelo = "modelo_it0",
AIC = 659.23,
R2 = .3289,
Observacion = "Todas las variables")
modelo_it1 <- glm(sobrevivio ~ clase + sexo + edad, data = datos_it2,
family = "binomial")
summary(modelo_it1)
print("Resultados del calculo del pseudo R2")
print(calcular_pseudo_R2(modelo_it1))
rm(list = ls())
datos_crudos <- read.csv(file ="../data/train.csv")
# Renombramos variables y dejamos las que no son de interes
datos_crudos$PassengerId <- NULL
datos_crudos$Name <- NULL
datos_it0 <- datos_crudos %>%
rename(sobrevivio = Survived, clase = Pclass, sexo = Sex, edad = Age, her_esp = SibSp,
padre_hijo = Parch, ticket = Ticket, precio_ticket = Fare, nro_cabina = Cabin,
puerto_embarcacion = Embarked)
str(datos_it0)
datos_it1 <- datos_it0 %>%
mutate(sobrevivio = factor(sobrevivio, levels = c(1, 0)),
clase = factor(clase, levels = c(1, 2, 3), labels = c("1ra", "2da", "3ra")),
sexo = factor(sexo, levels = c("male", "female"), labels = c("Hombre", "Mujer")),
nro_cabina = as.factor(nro_cabina),
ticket = as.factor(ticket),
puerto_embarcacion = as.factor(puerto_embarcacion))
str(datos_it1)
datos_it1 <- datos_it0 %>%
mutate(sobrevivio = factor(sobrevivio, levels = c(1, 0), labels = c(1, 0)),
clase = factor(clase, levels = c(1, 2, 3), labels = c("1ra", "2da", "3ra")),
sexo = factor(sexo, levels = c("male", "female"), labels = c("Hombre", "Mujer")),
nro_cabina = as.factor(nro_cabina),
ticket = as.factor(ticket),
puerto_embarcacion = as.factor(puerto_embarcacion))
str(datos_it1)
# Primero convertimos los niveles de sobrevivio para que queden mejor los gráficos
datos_grafico <- datos_it2 %>%
mutate(sobrevivio = factor(sobrevivio, levels = c(1,0), labels = c("Sí", "No")))
datos_crudos <- read.csv(file ="../data/train.csv")
# Renombramos variables y dejamos las que no son de interes
datos_crudos$PassengerId <- NULL
datos_crudos$Name <- NULL
datos_it0 <- datos_crudos %>%
rename(sobrevivio = Survived, clase = Pclass, sexo = Sex, edad = Age, her_esp = SibSp,
padre_hijo = Parch, ticket = Ticket, precio_ticket = Fare, nro_cabina = Cabin,
puerto_embarcacion = Embarked)
str(datos_it0)
datos_it1 <- datos_it0 %>%
mutate(sobrevivio = factor(sobrevivio),
clase = factor(clase, levels = c(1, 2, 3), labels = c("1ra", "2da", "3ra")),
sexo = factor(sexo, levels = c("male", "female"), labels = c("Hombre", "Mujer")),
nro_cabina = as.factor(nro_cabina),
ticket = as.factor(ticket),
puerto_embarcacion = as.factor(puerto_embarcacion))
str(datos_it1)
df_tabla <- datos_it1 %>%
select(where(is.numeric))
lista_tabla <- list(data = df_tabla, nombre_var = names(df_tabla))
kable(pmap_dfr(lista_tabla, medidas_resumen, remover_na = TRUE),
caption = "Medidas Resumen de Variables Cuantitativas")
df_tabla <- datos_it1 %>%
select(where(is.numeric))
lista_tabla <- list(data = df_tabla, nombre_var = names(df_tabla))
kable(pmap_dfr(lista_tabla, medidas_resumen, remover_na = TRUE),
caption = "Medidas Resumen de Variables Cuantitativas")
# Bilbiotecas a usar
library(dplyr)
library(ggplot2)
library(ggpubr)
library(caret) #confusionMatrix
library(car) #vif
library(ggthemes)
library(scales)
library(extrafont)
library(knitr)
library(purrr)
# Opciones en general
opts_chunk$set(echo = FALSE, fig.align = "center")
options(knitr.kable.NA = " ")
# Cargo funciones útiles
source("../R/Utils.R")
# Tema para los gráficos
theme_set(theme_gdocs() + theme(text = element_text(family = "Dubai Medium"),
axis.title = element_text(face = "italic", size = 15),
plot.title = element_text(face = "bold", size = 20, hjust = .5)))
df_tabla <- datos_it1 %>%
select(where(is.numeric))
lista_tabla <- list(data = df_tabla, nombre_var = names(df_tabla))
kable(pmap_dfr(lista_tabla, medidas_resumen, remover_na = TRUE),
caption = "Medidas Resumen de Variables Cuantitativas")
rm(df_tabla, lista_tabla)
datos_it2 <- datos_it1 %>% filter(!is.na(edad))
df_tabla <- datos_it2 %>%
select(where(is.factor))
kable(summary(df_tabla), )
rm(df_tabla)
# Primero convertimos los niveles de sobrevivio para que queden mejor los gráficos
datos_grafico <- datos_it2 %>%
mutate(sobrevivio = factor(sobrevivio, levels = c(1,0), labels = c("Sí", "No")))
g0 <- ggplot(datos_grafico, aes(y = ..count.. / sum(..count..))) + scale_y_continuous(labels = label_percent())
g1 <- g0 + geom_bar(aes(x = clase), fill = "firebrick", alpha = .6) + ylab("") + xlab("Clase")
g2 <- g0 + geom_bar(aes(x = sexo), fill = "darkblue", alpha = .6) + ylab("") + xlab("Sexo")
g3 <- g0 + geom_bar(aes(x = sobrevivio), fill = "darkorange", alpha = .6) + ylab("") + xlab("Sobrevivió")
arrange <- ggarrange(g1, g2, g3, nrow = 3, ncol = 1)
annotate_figure(arrange,
top = text_grob("Análisis Variables Categóricas", face = "bold", size = 20,
family = "Dubai Medium", hjust = .5))
modelo_it0 <- glm(sobrevivio ~ clase + sexo + edad + precio_ticket, data = datos_it2,
family = "binomial")
summary(modelo_it0)
print("Resultados del calculo del pseudo R2")
print(calcular_pseudo_R2(modelo_it0))
step(modelo_it0, direction = "both")
modelo_it1 <- glm(sobrevivio ~ clase + sexo + edad, data = datos_it2,
family = "binomial")
summary(modelo_it1)
print("Resultados del calculo del pseudo R2")
print(calcular_pseudo_R2(modelo_it1))
tabla_resumen_modelos <- tabla_resumen_modelos %>%
tabla_resumen_modelos
tabla_resumen_modelos <- data.frame(Modelo = "modelo_it0",
AIC = 659.23,
R2 = .3289,
Observacion = "Todas las variables")
# Bilbiotecas a usar
library(dplyr)
library(ggplot2)
library(ggpubr)
library(caret) #confusionMatrix
library(car) #vif
library(ggthemes)
library(scales)
library(extrafont)
library(knitr)
library(purrr)
# Opciones en general
opts_chunk$set(echo = FALSE, fig.align = "center")
options(knitr.kable.NA = " ")
# Cargo funciones útiles
source("../R/Utils.R")
# Tema para los gráficos
theme_set(theme_gdocs() + theme(text = element_text(family = "Dubai Medium"),
axis.title = element_text(face = "italic", size = 15),
plot.title = element_text(face = "bold", size = 20, hjust = .5)))
datos_crudos <- read.csv(file ="../data/train.csv")
# Renombramos variables y dejamos las que no son de interes
datos_crudos$PassengerId <- NULL
datos_crudos$Name <- NULL
datos_it0 <- datos_crudos %>%
rename(sobrevivio = Survived, clase = Pclass, sexo = Sex, edad = Age, her_esp = SibSp,
padre_hijo = Parch, ticket = Ticket, precio_ticket = Fare, nro_cabina = Cabin,
puerto_embarcacion = Embarked)
str(datos_it0)
datos_it1 <- datos_it0 %>%
mutate(sobrevivio = factor(sobrevivio),
clase = factor(clase, levels = c(1, 2, 3), labels = c("1ra", "2da", "3ra")),
sexo = factor(sexo, levels = c("male", "female"), labels = c("Hombre", "Mujer")),
nro_cabina = as.factor(nro_cabina),
ticket = as.factor(ticket),
puerto_embarcacion = as.factor(puerto_embarcacion))
str(datos_it1)
df_tabla <- datos_it1 %>%
select(where(is.numeric))
lista_tabla <- list(data = df_tabla, nombre_var = names(df_tabla))
kable(pmap_dfr(lista_tabla, medidas_resumen, remover_na = TRUE),
caption = "Medidas Resumen de Variables Cuantitativas")
rm(df_tabla, lista_tabla)
datos_it2 <- datos_it1 %>% filter(!is.na(edad))
df_tabla <- datos_it2 %>%
select(where(is.factor))
kable(summary(df_tabla), )
rm(df_tabla)
# Primero convertimos los niveles de sobrevivio para que queden mejor los gráficos
datos_grafico <- datos_it2 %>%
mutate(sobrevivio = factor(sobrevivio, levels = c(1,0), labels = c("Sí", "No")))
g0 <- ggplot(datos_grafico, aes(y = ..count.. / sum(..count..))) + scale_y_continuous(labels = label_percent())
g1 <- g0 + geom_bar(aes(x = clase), fill = "firebrick", alpha = .6) + ylab("") + xlab("Clase")
g2 <- g0 + geom_bar(aes(x = sexo), fill = "darkblue", alpha = .6) + ylab("") + xlab("Sexo")
g3 <- g0 + geom_bar(aes(x = sobrevivio), fill = "darkorange", alpha = .6) + ylab("") + xlab("Sobrevivió")
arrange <- ggarrange(g1, g2, g3, nrow = 3, ncol = 1)
annotate_figure(arrange,
top = text_grob("Análisis Variables Categóricas", face = "bold", size = 20,
family = "Dubai Medium", hjust = .5))
n <- nrow(datos_grafico)
g0 <- ggplot(datos_grafico)
g1 <- g0 + geom_histogram(aes(precio_ticket, ..density..), bins = calcular_cant_bins(n),
fill = "white", color = "darkblue",  alpha = .4) +
ylab("") +
xlab("Precio Ticket") +
scale_x_continuous(labels = label_number(prefix = "$"))
g2 <- g0 + geom_boxplot(aes(precio_ticket), color = "darkblue") +
ylab("") +
xlab("Precio Ticket") +
scale_x_continuous(labels = label_number(prefix = "$")) +
theme(axis.text.y = element_blank())
g3 <- g0 + geom_histogram(aes(edad, ..density..), bins = calcular_cant_bins(n),
color = "firebrick", fill = "white", alpha = .4) +
ylab("") +
xlab("Edad")
g4 <- g0 + geom_boxplot(aes(edad), color = "firebrick") +
ylab("") +
xlab("Edad") +
theme(axis.text.y = element_blank())
arrange <- ggarrange(g1, g2, g3, g4, nrow = 2, ncol = 2)
annotate_figure(arrange,
top = text_grob("Análisis Variables Cuantitativas", face = "bold", size = 20,
family = "Dubai Medium", hjust = .5))
g0 + geom_boxplot(aes(precio_ticket), color = "darkblue") +
ylab("") +
xlab("Precio Ticket") +
ggtitle("Boxplot de Precio Ticket (zoom)") +
theme(axis.text.y = element_blank()) +
coord_cartesian(xlim = c(0, 100)) +
scale_x_continuous(labels = label_number(prefix = "$"), breaks = seq(0, 100, 10))
g0 <- ggplot(datos_grafico, aes(x = sobrevivio, color = sobrevivio)) + xlab("")
g1 <- g0 + geom_boxplot(aes(y = precio_ticket)) +
ylab("Precio Ticket") +
scale_y_continuous(labels = label_number(prefix = "$"))
g2 <- g0 + geom_boxplot(aes(y = edad)) +
ylab("Edad")
arrange <- ggarrange(g1, g2, nrow = 1, ncol = 2, common.legend = TRUE, legend = "bottom")
annotate_figure(arrange,
top = text_grob("Variables Cuantitativas vs Sobrevivio", face = "bold", size = 20,
family = "Dubai Medium", hjust = .5))
g1 + coord_cartesian(ylim = c(0, 100)) +
ggtitle("Precio Ticket vs Sobrevivió (con zoom)") +
theme(legend.position =  "none") +
xlab("Sobrevivió")
kable(table(datos_grafico$sobrevivio, datos_grafico$clase))
kable(table(datos_grafico$sobrevivio, datos_grafico$sexo))
g1 <- hacer_barplot_con_dos_cuantitativas(datos_grafico, "clase", "sobrevivio", max = .7) +
xlab("Clase")
g2 <- hacer_barplot_con_dos_cuantitativas(datos_grafico, "sexo", "sobrevivio", max = .8) +
xlab("Sexo")
arrange <- ggarrange(g1, g2, nrow = 1, ncol = 2, common.legend = TRUE, legend = "bottom")
annotate_figure(arrange,
top = text_grob("Análisis Sobrevivió vs Cualitativas", face = "bold", size = 20,
family = "Dubai Medium", hjust = .5))
modelo_it0 <- glm(sobrevivio ~ clase + sexo + edad + precio_ticket, data = datos_it2,
family = "binomial")
summary(modelo_it0)
print("Resultados del calculo del pseudo R2")
print(calcular_pseudo_R2(modelo_it0))
tabla_resumen_modelos <- data.frame(Modelo = "modelo_it0",
AIC = 659.23,
R2 = .3289,
Observacion = "Todas las variables")
step(modelo_it0, direction = "both")
tabla_resumen_modelos
modelo_it1 <- glm(sobrevivio ~ clase + sexo + edad, data = datos_it2,
family = "binomial")
summary(modelo_it1)
print("Resultados del calculo del pseudo R2")
print(calcular_pseudo_R2(modelo_it1))
tabla_resumen_modelos
tabla_resumen_modelos <- tabla_resumen_modelos %>%
add_row(Modelo = "modelo_it1", AIC = 657.58, R2 = 0.3289, Observacion = "Se excluye a precio_ticket")
tabla_resumen_modelos
exp( -0.036985)
round((exp(2.522781) -1 )
asd
(exp(2.522781) -1 ) * 100
(exp(2.522781)
round((exp(2.522781) -1 ) * 100, 2)
(exp(2.522781)
round((exp(2.522781) -1 ) * 100, 2)
exp(2.522781)
exp(2.522781) -1 ) * 100
(exp(2.522781) -1 ) * 100
exp(2.522781)
ound((exp(0.39) -1 ) * 100, 2)%
round((exp(0.39) -1 ) * 100, 2)%
round((exp(0.39) -1 ) * 100, 2)
exp(.39)
round((exp(2.522781) -1 ) * 100, 2)
exp(2.522781)
puntos_influyentes_outliers <- data.frame(leverage = hatvalues(modelo_it1),
distancia_cook = cooks.distance(modelo_it1))
puntos_influyentes_outliers <- puntos_influyentes_outliers %>% arrange(-distancia_cook)
puntos_influyentes_outliers
# Bilbiotecas a usar
library(dplyr)
library(ggplot2)
library(ggpubr)
library(caret) #confusionMatrix
library(car) #vif
library(ggthemes)
library(scales)
library(extrafont)
library(knitr)
library(purrr)
# Opciones en general
opts_chunk$set(echo = FALSE, fig.align = "center")
options(knitr.kable.NA = " ")
# Cargo funciones útiles
source("../R/Utils.R")
# Tema para los gráficos
theme_set(theme_gdocs() + theme(text = element_text(family = "Dubai Medium"),
axis.title = element_text(face = "italic", size = 15),
plot.title = element_text(face = "bold", size = 20, hjust = .5)))
datos_crudos <- read.csv(file ="../data/train.csv")
# Renombramos variables y dejamos las que no son de interes
datos_crudos$PassengerId <- NULL
datos_crudos$Name <- NULL
datos_it0 <- datos_crudos %>%
rename(sobrevivio = Survived, clase = Pclass, sexo = Sex, edad = Age, her_esp = SibSp,
padre_hijo = Parch, ticket = Ticket, precio_ticket = Fare, nro_cabina = Cabin,
puerto_embarcacion = Embarked)
str(datos_it0)
datos_it1 <- datos_it0 %>%
mutate(sobrevivio = factor(sobrevivio),
clase = factor(clase, levels = c(1, 2, 3), labels = c("1ra", "2da", "3ra")),
sexo = factor(sexo, levels = c("male", "female"), labels = c("Hombre", "Mujer")),
nro_cabina = as.factor(nro_cabina),
ticket = as.factor(ticket),
puerto_embarcacion = as.factor(puerto_embarcacion))
str(datos_it1)
df_tabla <- datos_it1 %>%
select(where(is.numeric))
lista_tabla <- list(data = df_tabla, nombre_var = names(df_tabla))
kable(pmap_dfr(lista_tabla, medidas_resumen, remover_na = TRUE),
caption = "Medidas Resumen de Variables Cuantitativas")
rm(df_tabla, lista_tabla)
datos_it2 <- datos_it1 %>% filter(!is.na(edad))
df_tabla <- datos_it2 %>%
select(where(is.factor))
kable(summary(df_tabla), )
rm(df_tabla)
# Primero convertimos los niveles de sobrevivio para que queden mejor los gráficos
datos_grafico <- datos_it2 %>%
mutate(sobrevivio = factor(sobrevivio, levels = c(1,0), labels = c("Sí", "No")))
g0 <- ggplot(datos_grafico, aes(y = ..count.. / sum(..count..))) + scale_y_continuous(labels = label_percent())
g1 <- g0 + geom_bar(aes(x = clase), fill = "firebrick", alpha = .6) + ylab("") + xlab("Clase")
g2 <- g0 + geom_bar(aes(x = sexo), fill = "darkblue", alpha = .6) + ylab("") + xlab("Sexo")
g3 <- g0 + geom_bar(aes(x = sobrevivio), fill = "darkorange", alpha = .6) + ylab("") + xlab("Sobrevivió")
arrange <- ggarrange(g1, g2, g3, nrow = 3, ncol = 1)
annotate_figure(arrange,
top = text_grob("Análisis Variables Categóricas", face = "bold", size = 20,
family = "Dubai Medium", hjust = .5))
n <- nrow(datos_grafico)
g0 <- ggplot(datos_grafico)
g1 <- g0 + geom_histogram(aes(precio_ticket, ..density..), bins = calcular_cant_bins(n),
fill = "white", color = "darkblue",  alpha = .4) +
ylab("") +
xlab("Precio Ticket") +
scale_x_continuous(labels = label_number(prefix = "$"))
g2 <- g0 + geom_boxplot(aes(precio_ticket), color = "darkblue") +
ylab("") +
xlab("Precio Ticket") +
scale_x_continuous(labels = label_number(prefix = "$")) +
theme(axis.text.y = element_blank())
g3 <- g0 + geom_histogram(aes(edad, ..density..), bins = calcular_cant_bins(n),
color = "firebrick", fill = "white", alpha = .4) +
ylab("") +
xlab("Edad")
g4 <- g0 + geom_boxplot(aes(edad), color = "firebrick") +
ylab("") +
xlab("Edad") +
theme(axis.text.y = element_blank())
arrange <- ggarrange(g1, g2, g3, g4, nrow = 2, ncol = 2)
annotate_figure(arrange,
top = text_grob("Análisis Variables Cuantitativas", face = "bold", size = 20,
family = "Dubai Medium", hjust = .5))
g0 + geom_boxplot(aes(precio_ticket), color = "darkblue") +
ylab("") +
xlab("Precio Ticket") +
ggtitle("Boxplot de Precio Ticket (zoom)") +
theme(axis.text.y = element_blank()) +
coord_cartesian(xlim = c(0, 100)) +
scale_x_continuous(labels = label_number(prefix = "$"), breaks = seq(0, 100, 10))
g0 <- ggplot(datos_grafico, aes(x = sobrevivio, color = sobrevivio)) + xlab("")
g1 <- g0 + geom_boxplot(aes(y = precio_ticket)) +
ylab("Precio Ticket") +
scale_y_continuous(labels = label_number(prefix = "$"))
g2 <- g0 + geom_boxplot(aes(y = edad)) +
ylab("Edad")
arrange <- ggarrange(g1, g2, nrow = 1, ncol = 2, common.legend = TRUE, legend = "bottom")
annotate_figure(arrange,
top = text_grob("Variables Cuantitativas vs Sobrevivio", face = "bold", size = 20,
family = "Dubai Medium", hjust = .5))
g1 + coord_cartesian(ylim = c(0, 100)) +
ggtitle("Precio Ticket vs Sobrevivió (con zoom)") +
theme(legend.position =  "none") +
xlab("Sobrevivió")
kable(table(datos_grafico$sobrevivio, datos_grafico$clase))
kable(table(datos_grafico$sobrevivio, datos_grafico$sexo))
g1 <- hacer_barplot_con_dos_cuantitativas(datos_grafico, "clase", "sobrevivio", max = .7) +
xlab("Clase")
g2 <- hacer_barplot_con_dos_cuantitativas(datos_grafico, "sexo", "sobrevivio", max = .8) +
xlab("Sexo")
arrange <- ggarrange(g1, g2, nrow = 1, ncol = 2, common.legend = TRUE, legend = "bottom")
annotate_figure(arrange,
top = text_grob("Análisis Sobrevivió vs Cualitativas", face = "bold", size = 20,
family = "Dubai Medium", hjust = .5))
modelo_it0 <- glm(sobrevivio ~ clase + sexo + edad + precio_ticket, data = datos_it2,
family = "binomial")
summary(modelo_it0)
print("Resultados del calculo del pseudo R2")
print(calcular_pseudo_R2(modelo_it0))
tabla_resumen_modelos <- data.frame(Modelo = "modelo_it0",
AIC = 659.23,
R2 = .3289,
Observacion = "Todas las variables")
step(modelo_it0, direction = "both")
modelo_it1 <- glm(sobrevivio ~ clase + sexo + edad, data = datos_it2,
family = "binomial")
summary(modelo_it1)
print("Resultados del calculo del pseudo R2")
print(calcular_pseudo_R2(modelo_it1))
tabla_resumen_modelos <- tabla_resumen_modelos %>%
add_row(Modelo = "modelo_it1", AIC = 657.58, R2 = 0.3289, Observacion = "Se excluye a precio_ticket")
puntos_influyentes_outliers <- data.frame(leverage = hatvalues(modelo_it1),
distancia_cook = cooks.distance(modelo_it1))
puntos_influyentes_outliers <- puntos_influyentes_outliers %>% arrange(-distancia_cook)
puntos_influyentes_outliers
datos_it2[214,]
datos_it2[241,]
modelo_it2 <- glm(sobrevivio ~ clase + sexo + edad + precio_ticket, data = datos_it2[-241,],
family = "binomial")
summary(modelo_it2)
print(calcular_pseudo_R2(modelo_it1))
modelo_it2 <- glm(sobrevivio ~ clase + sexo + edad + precio_ticket, data = datos_it2[-241,],
family = "binomial")
summary(modelo_it2)
print("Resultados del calculo del pseudo R2")
print(calcular_pseudo_R2(modelo_it1))
tabla_resumen_modelos <- tabla_resumen_modelos %>%
add_row(Modelo = "modelo_it2", AIC = 651.57, R2 = 0.3289, Observacion = "Se excluye a observación 241 y todas las variables")
tabla_resumen_modelos
tabla_resumen_modelos <- tabla_resumen_modelos %>%
add_row(Modelo = "modelo_it2", AIC = 651.57, R2 = 0.3289, Observacion = "Se excluye a observación 241 y se presentan todas las variables")
tabla_resumen_modelos
tabla_resumen_modelos[3,] <- NULL
tabla_resumen_modelos[3,] <- null
tabla_resumen_modelos[3,] <- NULL
tabla_resumen_modelos <- tabla_resumen_modelos[-3,]
tabla_resumen_modelos
step(modelo_it2, direction = "both")
En el modelo resultante se vuelve a excluir **precio_ticket**
modelo_it2 <- glm(sobrevivio ~ clase + sexo + edad + precio_ticket, data = datos_it2[-241,],
family = "binomial")
summary(modelo_it2)
print("Resultados del calculo del pseudo R2")
print(calcular_pseudo_R2(modelo_it2))
tabla_resumen_modelos <- tabla_resumen_modelos %>%
add_row(Modelo = "modelo_it2", AIC = 651.57, R2 = 0.3362, Observacion = "Se excluye a observación 241 y se presentan todas las variables")
tabla_resumen_modelos
tabla_resumen_modelos <- tabla_resumen_modelos[-3,]
tabla_resumen_modelos
step(modelo_it2, direction = "both")
modelo_it3 <- glm(sobrevivio ~ clase + sexo + edad, data = datos_it2[-241,],
family = "binomial")
summary(modelo_it3)
print("Resultados del calculo del pseudo R2")
print(calcular_pseudo_R2(modelo_it3))
tabla_resumen_modelos <- tabla_resumen_modelos %>%
add_row(Modelo = "modelo_it3", AIC = 649.68, R2 = 0.3361, Observacion = "Se excluye a observación 241 y a precio_ticket")
tabla_resumen_modelos
puntos_influyentes_outliers <- data.frame(leverage = hatvalues(modelo_it3),
distancia_cook = cooks.distance(modelo_it3))
puntos_influyentes_outliers <- puntos_influyentes_outliers %>% arrange(-distancia_cook)
puntos_influyentes_outliers
source('C:/Users/tomas/OneDrive/Escritorio/ProyectosR/exer/PracticaInvestigacion/R/ejemplo.R', encoding = 'UTF-8', echo=TRUE)
source('C:/Users/tomas/OneDrive/Escritorio/ProyectosR/exer/PracticaInvestigacion/R/ejemplo.R', encoding = 'UTF-8', echo=TRUE)
View(datos)
