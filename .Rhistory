}
hacer_barplot_con_dos_cuantitativas(datos_it1, clase, sobrevivio)
hacer_barplot_con_dos_cuantitativas(datos_it1, clase, sobrevivio)
hacer_barplot_con_dos_cuantitativas(datos_it1, "clase", "sobrevivio")
datos %>%
group_by(eval(var2), eval(var1)) %>%
summarise(n = n()) %>%
mutate(freq_rel = n / sum(n)) %>%
ggplot(aes(eval(var1), freq_rel, group = eval(var2))) +
geom_bar(color = "darkblue", alpha = .6, stat = "identity") +
facet_grid(. ~ eval(var2))
hacer_barplot_con_dos_cuantitativas <- function(datos, var1, var2){
datos %>%
group_by(eval(var2), eval(var1)) %>%
summarise(n = n()) %>%
mutate(freq_rel = n / sum(n)) %>%
ggplot(aes(eval(var1), freq_rel, group = eval(var2))) +
geom_bar(color = "darkblue", alpha = .6, stat = "identity") +
facet_grid(. ~ eval(var2))
}
hacer_barplot_con_dos_cuantitativas(datos_it1, "clase", "sobrevivio")
hacer_barplot_con_dos_cuantitativas <- function(datos, var1, var2){
datos %>%
group_by(eval(var2), eval(var1)) %>%
summarise(n = n()) %>%
mutate(freq_rel = n / sum(n)) %>%
ggplot(aes(eval(var1), freq_rel, group = eval(var2))) +
geom_bar(color = "darkblue", alpha = .6, stat = "identity") #+
facet_grid(. ~ eval(var2))
}
hacer_barplot_con_dos_cuantitativas(datos_it1, "clase", "sobrevivio")
hacer_barplot_con_dos_cuantitativas <- function(datos, var1, var2){
datos %>%
group_by(eval(var2), eval(var1)) %>%
summarise(n = n()) %>%
mutate(freq_rel = n / sum(n)) %>%
ggplot(aes(eval(var1), freq_rel, group = eval(var2))) +
geom_bar(color = "darkblue", alpha = .6, stat = "identity") #+
facet_grid(. ~ eval(var2))
}
hacer_barplot_con_dos_cuantitativas(datos_it1, "clase", "sobrevivio")
datos %>%
group_by(eval(var2), eval(var1)) %>%
summarise(n = n()) %>%
mutate(freq_rel = n / sum(n)) %>%
ggplot(aes(eval(var1), freq_rel, group = eval(var2))) +
geom_bar(color = "darkblue", alpha = .6, stat = "identity") +
facet_grid(. ~ eval(var2))
hacer_barplot_con_dos_cuantitativas <- function(datos, var1, var2){
datos %>%
group_by(eval(var2), eval(var1)) %>%
summarise(n = n()) %>%
mutate(freq_rel = n / sum(n)) %>%
ggplot(aes(eval(var1), freq_rel, group = eval(var2))) +
geom_bar(color = "darkblue", alpha = .6, stat = "identity") +
facet_grid(. ~ eval(var2))
}
hacer_barplot_con_dos_cuantitativas(datos_it1, "clase", "sobrevivio")
x <- "sobrevivio"
ggplot(datos_it1, aes(eval(X))) + geom_bar()
x <- "sobrevivio"
ggplot(datos_it1, aes(eval(X))) + geom_bar()
x <- "sobrevivio"
ggplot(datos_it1, aes(eval(x))) + geom_bar()
ggplot(datos_it1, aes_string(eval(x))) + geom_bar()
hacer_barplot_con_dos_cuantitativas <- function(datos, var1, var2){
datos %>%
group_by(eval(var2), eval(var1)) %>%
summarise(n = n()) %>%
mutate(freq_rel = n / sum(n)) %>%
ggplot(aes_string(eval(var1), "freq_rel", group = eval(var2))) +
geom_bar(color = "darkblue", alpha = .6, stat = "identity") +
facet_grid(. ~ eval(var2))
}
hacer_barplot_con_dos_cuantitativas(datos_it1, "clase", "sobrevivio")
hacer_barplot_con_dos_cuantitativas <- function(datos, var1, var2){
datos %>%
group_by(eval(var2), eval(var1)) %>%
summarise(n = n()) %>%
mutate(freq_rel = n / sum(n)) %>%
ggplot(aes_string(eval(var1), "freq_rel", group = eval(var2))) +
geom_bar(color = "darkblue", alpha = .6, stat = "identity") +
facet_grid(. ~ eval(var2))
}
hacer_barplot_con_dos_cuantitativas(datos_it1, "clase", "sobrevivio")
hacer_barplot_con_dos_cuantitativas(datos_it1, "clase", "sobrevivio")
hacer_barplot_con_dos_cuantitativas <- function(datos, var1, var2){
datos %>%
group_by(eval(var2), eval(var1)) %>%
summarise(n = n()) %>%
mutate(freq_rel = n / sum(n)) %>%
ggplot(aes_string(eval(var1), "freq_rel", group = eval(var2))) +
geom_bar(color = "darkblue", alpha = .6, stat = "identity")# +
facet_grid(. ~ eval(var2))
}
hacer_barplot_con_dos_cuantitativas(datos_it1, "clase", "sobrevivio")
datos %>%
group_by(eval(var2), eval(var1)) %>%
summarise(n = n()) %>%
mutate(freq_rel = n / sum(n)) %>%
ggplot(aes_string(eval(var1), "freq_rel", group = eval(var2))) +
geom_bar(color = "darkblue", alpha = .6, stat = "identity") +
facet_grid(. ~ eval(var2))
hacer_barplot_con_dos_cuantitativas <- function(datos, var1, var2){
datos %>%
group_by(eval(var2), eval(var1)) %>%
summarise(n = n()) %>%
mutate(freq_rel = n / sum(n)) %>%
ggplot(aes_string(eval(var1), "freq_rel", group = eval(var2))) +
geom_bar(color = "darkblue", alpha = .6, stat = "identity") +
facet_grid(. ~ eval(var2))
}
expr(eval(x))
expr(eval(x))
eval(x)
expr(x)
expr(eval(x))
sym(x)
eval(sym(x))
hacer_barplot_con_dos_cuantitativas <- function(datos, var1, var2){
datos %>%
group_by(sym(var2), sym(var1)) %>%
summarise(n = n()) %>%
mutate(freq_rel = n / sum(n)) %>%
ggplot(aes(sym(var1), freq_rel, group = sym(var2))) +
geom_bar(color = "darkblue", alpha = .6, stat = "identity") +
facet_grid(. ~ sym(var2))
}
hacer_barplot_con_dos_cuantitativas(datos_it1, "clase", "sobrevivio")
hacer_barplot_con_dos_cuantitativas <- function(datos, var1, var2){
datos %>%
group_by(!!sym(var2), !!sym(var1)) %>%
summarise(n = n()) %>%
mutate(freq_rel = n / sum(n)) %>%
ggplot(aes(sym(var1), freq_rel, group = sym(var2))) +
geom_bar(color = "darkblue", alpha = .6, stat = "identity") +
facet_grid(. ~ sym(var2))
}
hacer_barplot_con_dos_cuantitativas(datos_it1, "clase", "sobrevivio")
library(rlang)
hacer_barplot_con_dos_cuantitativas <- function(datos, var1, var2){
datos %>%
group_by(!!sym(var2), !!sym(var1)) %>%
summarise(n = n()) %>%
mutate(freq_rel = n / sum(n)) %>%
ggplot(aes(sym(var1), freq_rel, group = sym(var2))) +
geom_bar(color = "darkblue", alpha = .6, stat = "identity") +
facet_grid(. ~ sym(var2))
}
hacer_barplot_con_dos_cuantitativas(datos_it1, "clase", "sobrevivio")
hacer_barplot_con_dos_cuantitativas <- function(datos, var1, var2){
datos %>%
group_by(!!sym(var2), !!sym(var1)) %>%
summarise(n = n()) %>%
mutate(freq_rel = n / sum(n)) %>%
ggplot(aes(!!sym(var1), freq_rel, group = !!sym(var2))) +
geom_bar(color = "darkblue", alpha = .6, stat = "identity") +
facet_grid(. ~ !!sym(var2))
}
hacer_barplot_con_dos_cuantitativas(datos_it1, "clase", "sobrevivio")
hacer_barplot_con_dos_cuantitativas <- function(datos, var1, var2){
datos %>%
group_by(eval(var2), eval(var1)) %>%
summarise(n = n()) %>%
mutate(freq_rel = n / sum(n)) %>%
ggplot(aes(sym(var1), freq_rel, group = sym(var2))) +
geom_bar(color = "darkblue", alpha = .6, stat = "identity") +
facet_grid(. ~ !!sym(var2))
}
hacer_barplot_con_dos_cuantitativas(datos_it1, "clase", "sobrevivio")
datos %>%
group_by(eval(var2), eval(var1)) %>%
summarise(n = n()) %>%
mutate(freq_rel = n / sum(n)) %>%
ggplot(aes(sym(var1), freq_rel, group = sym(var2))) +
geom_bar(color = "darkblue", alpha = .6, stat = "identity") +
facet_grid(. ~ sym(var2))
hacer_barplot_con_dos_cuantitativas <- function(datos, var1, var2){
datos %>%
group_by(eval(var2), eval(var1)) %>%
summarise(n = n()) %>%
mutate(freq_rel = n / sum(n)) %>%
ggplot(aes(sym(var1), freq_rel, group = sym(var2))) +
geom_bar(color = "darkblue", alpha = .6, stat = "identity") +
facet_grid(. ~ sym(var2))
}
hacer_barplot_con_dos_cuantitativas(datos_it1, "clase", "sobrevivio")
hacer_barplot_con_dos_cuantitativas <- function(datos, var1, var2){
datos %>%
group_by(eval(var2), eval(var1)) %>%
summarise(n = n()) %>%
mutate(freq_rel = n / sum(n)) %>%
ggplot(aes(sym(var1), freq_rel, group = sym(var2))) +
geom_bar(color = "darkblue", alpha = .6, stat = "identity") +
facet_grid(. ~ eval(var2))
}
hacer_barplot_con_dos_cuantitativas(datos_it1, "clase", "sobrevivio")
hacer_barplot_con_dos_cuantitativas <- function(datos, var1, var2){
datos %>%
group_by(eval(var2), eval(var1)) %>%
summarise(n = n()) %>%
mutate(freq_rel = n / sum(n)) %>%
ggplot(ae_strings(eval(var1), freq_rel, group = eval(var2))) +
geom_bar(color = "darkblue", alpha = .6, stat = "identity") +
facet_grid(. ~ eval(var2))
}
hacer_barplot_con_dos_cuantitativas(datos_it1, "clase", "sobrevivio")
hacer_barplot_con_dos_cuantitativas <- function(datos, var1, var2){
datos %>%
group_by(eval(var2), eval(var1)) %>%
summarise(n = n()) %>%
mutate(freq_rel = n / sum(n)) %>%
ggplot(aes_strings(eval(var1), freq_rel, group = eval(var2))) +
geom_bar(color = "darkblue", alpha = .6, stat = "identity") +
facet_grid(. ~ eval(var2))
}
hacer_barplot_con_dos_cuantitativas(datos_it1, "clase", "sobrevivio")
hacer_barplot_con_dos_cuantitativas <- function(datos, var1, var2){
datos %>%
group_by(eval(var2), eval(var1)) %>%
summarise(n = n()) %>%
mutate(freq_rel = n / sum(n)) %>%
ggplot(aes_string(eval(var1), freq_rel, group = eval(var2))) +
geom_bar(color = "darkblue", alpha = .6, stat = "identity") +
facet_grid(. ~ eval(var2))
}
hacer_barplot_con_dos_cuantitativas(datos_it1, "clase", "sobrevivio")
hacer_barplot_con_dos_cuantitativas <- function(datos, var1, var2){
datos %>%
group_by(eval(var2), eval(var1)) %>%
summarise(n = n()) %>%
mutate(freq_rel = n / sum(n)) %>%
ggplot(aes_string(eval(var1), "freq_rel", group = eval(var2))) +
geom_bar(color = "darkblue", alpha = .6, stat = "identity") +
facet_grid(. ~ eval(var2))
}
hacer_barplot_con_dos_cuantitativas(datos_it1, "clase", "sobrevivio")
sym(!!eval(x))
sym(!! eval(x))
sym(eval(x))
hacer_barplot_con_dos_cuantitativas <- function(datos, var1, var2){
datos %>%
group_by(eval(var2), eval(var1)) %>%
summarise(n = n()) %>%
mutate(freq_rel = n / sum(n)) %>%
ggplot(aes_string(eval(var1), "freq_rel", group = eval(var2))) +
geom_bar(color = "darkblue", alpha = .6, stat = "identity") +
facet_grid(. ~ sym(eval(var2)))
}
hacer_barplot_con_dos_cuantitativas(datos_it1, "clase", "sobrevivio")
vars()
?vars
vars(eval(x))
hacer_barplot_con_dos_cuantitativas
hacer_barplot_con_dos_cuantitativas <- function(datos, var1, var2){
datos %>%
group_by(eval(var2), eval(var1)) %>%
summarise(n = n()) %>%
mutate(freq_rel = n / sum(n)) %>%
ggplot(aes_string(eval(var1), "freq_rel", group = eval(var2))) +
geom_bar(color = "darkblue", alpha = .6, stat = "identity") +
facet_grid(cols =  vars(sym(eval(var2))))
}
hacer_barplot_con_dos_cuantitativas(datos_it1, "clase", "sobrevivio")
hacer_barplot_con_dos_cuantitativas <- function(datos, var1, var2){
datos %>%
group_by(eval(var2), eval(var1)) %>%
summarise(n = n()) %>%
mutate(freq_rel = n / sum(n)) %>%
ggplot(aes_string(eval(var1), "freq_rel", group = eval(var2))) +
geom_bar(color = "darkblue", alpha = .6, stat = "identity") +
facet_grid(cols =  vars(eval(var2)))
}
hacer_barplot_con_dos_cuantitativas(datos_it1, "clase", "sobrevivio")
datos %>%
group_by(eval(var2), eval(var1)) %>%
summarise(n = n()) %>%
mutate(freq_rel = n / sum(n)) %>%
ggplot(aes_string(var1, "freq_rel", group = var2)) +
geom_bar(color = "darkblue", alpha = .6, stat = "identity") +
facet_grid(cols =  var2)
hacer_barplot_con_dos_cuantitativas <- function(datos, var1, var2){
datos %>%
group_by(eval(var2), eval(var1)) %>%
summarise(n = n()) %>%
mutate(freq_rel = n / sum(n)) %>%
ggplot(aes_string(var1, "freq_rel", group = var2)) +
geom_bar(color = "darkblue", alpha = .6, stat = "identity") +
facet_grid(cols =  var2)
}
hacer_barplot_con_dos_cuantitativas(datos_it1, "clase", "sobrevivio")
hacer_barplot_con_dos_cuantitativas <- function(datos, var1, var2){
datos %>%
group_by(eval(var2), eval(var1)) %>%
summarise(n = n()) %>%
mutate(freq_rel = n / sum(n)) %>%
ggplot(aes_string(var1, "freq_rel", group = var2)) +
geom_bar(color = "darkblue", alpha = .6, stat = "identity") +
facet_grid(cols =  vars(var2))
}
hacer_barplot_con_dos_cuantitativas(datos_it1, "clase", "sobrevivio")
datos %>%
group_by(eval(var2), eval(var1)) %>%
summarise(n = n()) %>%
mutate(freq_rel = n / sum(n)) %>%
ggplot(aes_string(var1, "freq_rel", group = var2)) +
geom_bar(color = "darkblue", alpha = .6, stat = "identity") +
facet_grid(. ~ var2)
hacer_barplot_con_dos_cuantitativas <- function(datos, var1, var2){
datos %>%
group_by(eval(var2), eval(var1)) %>%
summarise(n = n()) %>%
mutate(freq_rel = n / sum(n)) %>%
ggplot(aes_string(var1, "freq_rel", group = var2)) +
geom_bar(color = "darkblue", alpha = .6, stat = "identity") +
facet_grid(. ~ var2)
}
hacer_barplot_con_dos_cuantitativas(datos_it1, "clase", "sobrevivio")
hacer_barplot_con_dos_cuantitativas(datos_it1, "clase", "sobrevivio")
hacer_barplot_con_dos_cuantitativas <- function(datos, var1, var2){
datos %>%
group_by(eval(var2), eval(var1)) %>%
summarise(n = n()) %>%
mutate(freq_rel = n / sum(n)) %>%
ggplot(aes_string(var1, "freq_rel")) +
geom_bar(color = "darkblue", alpha = .6, stat = "identity")# +
}
hacer_barplot_con_dos_cuantitativas(datos_it1, "clase", "sobrevivio")
hacer_barplot_con_dos_cuantitativas(datos_it1, "clase", "sobrevivio")
hacer_barplot_con_dos_cuantitativas(datos_it1, "clase", "sobrevivio")
hacer_barplot_con_dos_cuantitativas(datos_it1, "clase", "sobrevivio")
}
hacer_barplot_con_dos_cuantitativas(datos_it1, "clase", "sobrevivio")
hacer_barplot_con_dos_cuantitativas <- function(datos, var1, var2){
datos %>%
group_by(eval(var2), eval(var1)) %>%
summarise(n = n()) %>%
mutate(freq_rel = n / sum(n)) %>%
ggplot(aes(sym(var1), freq_rel)) +
geom_bar(color = "darkblue", alpha = .6, stat = "identity")# +
}
hacer_barplot_con_dos_cuantitativas(datos_it1, "clase", "sobrevivio")
hacer_barplot_con_dos_cuantitativas <- function(datos, var1, var2){
datos %>%
group_by(eval(var2), eval(var1)) %>%
summarise(n = n()) %>%
mutate(freq_rel = n / sum(n)) %>%
ggplot(aes(eval(var1), freq_rel)) +
geom_bar(color = "darkblue", alpha = .6, stat = "identity")# +
}
hacer_barplot_con_dos_cuantitativas(datos_it1, "clase", "sobrevivio")
hacer_barplot_con_dos_cuantitativas <- function(datos, var1, var2){
datos %>%
group_by(eval(var2), eval(var1)) %>%
summarise(n = n()) %>%
mutate(freq_rel = n / sum(n)) %>%
ggplot(aes_string(eval(var1), freq_rel)) +
geom_bar(color = "darkblue", alpha = .6, stat = "identity")# +
}
hacer_barplot_con_dos_cuantitativas(datos_it1, "clase", "sobrevivio")
hacer_barplot_con_dos_cuantitativas <- function(datos, var1, var2){
datos %>%
group_by(eval(var2), eval(var1)) %>%
summarise(n = n()) %>%
mutate(freq_rel = n / sum(n)) %>%
ggplot(aes_string(eval(var1), "freq_rel")) +
geom_bar(color = "darkblue", alpha = .6, stat = "identity")# +
}
hacer_barplot_con_dos_cuantitativas(datos_it1, "clase", "sobrevivio")
datos_it1 %>%
group_by(eval(x), clase) %>%
summarise(n = n()) %>%
mutate(total = sum(n))
datos_it1 %>%
group_by(eval(x), clase) %>%
summarise(n = n()) %>%
mutate(total = sum(n))
datos_it1 %>%
group_by(sym(x), clase) %>%
summarise(n = n()) %>%
mutate(total = sum(n))
datos_it1 %>%
group_by(sym(x), clase) %>%
summarise(n = n()) %>%
mutate(total = sum(n))
datos_it1 %>%
group_by(!!sym(x), clase) %>%
summarise(n = n()) %>%
mutate(total = sum(n))
hacer_barplot_con_dos_cuantitativas <- function(datos, var1, var2){
datos %>%
group_by(!!sym(var2), !!sym(var1)) %>%
summarise(n = n()) %>%
mutate(freq_rel = n / sum(n)) %>%
ggplot(aes_string(var1, "freq_rel")) +
geom_bar(color = "darkblue", alpha = .6, stat = "identity")# +
}
hacer_barplot_con_dos_cuantitativas(datos_it1, "clase", "sobrevivio")
hacer_barplot_con_dos_cuantitativas <- function(datos, var1, var2){
datos %>%
group_by(!!sym(var2), !!sym(var1)) %>%
summarise(n = n()) %>%
mutate(freq_rel = n / sum(n)) %>%
ggplot(aes_string(var1, "freq_rel", group = var2)) +
geom_bar(color = "darkblue", alpha = .6, stat = "identity") +
facet_grid(. ~ var2)
}
hacer_barplot_con_dos_cuantitativas(datos_it1, "clase", "sobrevivio")
datos %>%
group_by(!!sym(var2), !!sym(var1)) %>%
summarise(n = n()) %>%
mutate(freq_rel = n / sum(n)) %>%
ggplot(aes_string(var1, "freq_rel", group = var2)) +
geom_bar(color = "darkblue", alpha = .6, stat = "identity") +
facet_grid(. ~ eval(var2))
hacer_barplot_con_dos_cuantitativas <- function(datos, var1, var2){
datos %>%
group_by(!!sym(var2), !!sym(var1)) %>%
summarise(n = n()) %>%
mutate(freq_rel = n / sum(n)) %>%
ggplot(aes_string(var1, "freq_rel", group = var2)) +
geom_bar(color = "darkblue", alpha = .6, stat = "identity") +
facet_grid(. ~ eval(var2))
}
hacer_barplot_con_dos_cuantitativas(datos_it1, "clase", "sobrevivio")
hacer_barplot_con_dos_cuantitativas <- function(datos, var1, var2){
datos %>%
group_by(!!sym(var2), !!sym(var1)) %>%
summarise(n = n()) %>%
mutate(freq_rel = n / sum(n)) %>%
ggplot(aes_string(var1, "freq_rel", group = var2)) +
geom_bar(color = "darkblue", alpha = .6, stat = "identity") +
facet_grid(. ~ sym(eval(var2)))
}
hacer_barplot_con_dos_cuantitativas(datos_it1, "clase", "sobrevivio")
hacer_barplot_con_dos_cuantitativas <- function(datos, var1, var2){
datos %>%
group_by(!!sym(var2), !!sym(var1)) %>%
summarise(n = n()) %>%
mutate(freq_rel = n / sum(n)) %>%
ggplot(aes_string(var1, "freq_rel", group = var2)) +
geom_bar(color = "darkblue", alpha = .6, stat = "identity")# +
#facet_grid(. ~ sym(eval(var2)))
}
hacer_barplot_con_dos_cuantitativas(datos_it1, "clase", "sobrevivio")
hacer_barplot_con_dos_cuantitativas <- function(datos, var1, var2){
datos %>%
group_by(!!sym(var2), !!sym(var1)) %>%
summarise(n = n()) %>%
mutate(freq_rel = n / sum(n)) %>%
ggplot(aes_string(var1, "freq_rel", group = var2)) +
geom_bar(color = "darkblue", alpha = .6, stat = "identity", position =  "dodge")
}
hacer_barplot_con_dos_cuantitativas(datos_it1, "clase", "sobrevivio")
hacer_barplot_con_dos_cuantitativas <- function(datos, var1, var2){
datos %>%
group_by(!!sym(var2), !!sym(var1)) %>%
summarise(n = n()) %>%
mutate(freq_rel = n / sum(n)) %>%
ggplot(aes_string(var1, "freq_rel", group = var2, color = var2)) +
geom_bar(fill = "white", alpha = .6, stat = "identity", position =  "dodge")
}
hacer_barplot_con_dos_cuantitativas(datos_it1, "clase", "sobrevivio")
datos %>%
group_by(!!sym(var2), !!sym(var1)) %>%
summarise(n = n()) %>%
mutate(freq_rel = n / sum(n)) %>%
ggplot(aes_string(var1, "freq_rel", group = var2, color = var2)) +
geom_bar(fill = "white", alpha = .2, stat = "identity", position =  "dodge")
hacer_barplot_con_dos_cuantitativas <- function(datos, var1, var2){
datos %>%
group_by(!!sym(var2), !!sym(var1)) %>%
summarise(n = n()) %>%
mutate(freq_rel = n / sum(n)) %>%
ggplot(aes_string(var1, "freq_rel", group = var2, color = var2)) +
geom_bar(fill = "white", alpha = .2, stat = "identity", position =  "dodge")
}
hacer_barplot_con_dos_cuantitativas(datos_it1, "clase", "sobrevivio")
}
hacer_barplot_con_dos_cuantitativas <- function(datos, var1, var2){
datos %>%
group_by(!!sym(var2), !!sym(var1)) %>%
summarise(n = n()) %>%
mutate(freq_rel = n / sum(n)) %>%
ggplot(aes_string(var1, "freq_rel", group = var2, color = var2)) +
geom_bar(fill = "white", alpha = .2, stat = "identity", position =  "dodge2")
}
hacer_barplot_con_dos_cuantitativas(datos_it1, "clase", "sobrevivio")
hacer_barplot_con_dos_cuantitativas <- function(datos, var1, var2){
datos %>%
group_by(!!sym(var2), !!sym(var1)) %>%
summarise(n = n()) %>%
mutate(freq_rel = n / sum(n)) %>%
ggplot(aes_string(var1, "freq_rel", group = var2, fill = var2)) +
geom_bar(alpha = .2, stat = "identity", position =  "dodge2")
}
hacer_barplot_con_dos_cuantitativas(datos_it1, "clase", "sobrevivio")
hacer_barplot_con_dos_cuantitativas <- function(datos, var1, var2){
datos %>%
group_by(!!sym(var2), !!sym(var1)) %>%
summarise(n = n()) %>%
mutate(freq_rel = n / sum(n)) %>%
ggplot(aes_string(var1, "freq_rel", group = var2, fill = var2)) +
geom_bar(alpha = .6, stat = "identity", position =  "dodge2")
}
hacer_barplot_con_dos_cuantitativas(datos_it1, "clase", "sobrevivio")
g1 <- hacer_barplot_con_dos_cuantitativas(datos_it1, "clase", "sobrevivio")
g2 <- hacer_barplot_con_dos_cuantitativas(datos_it1, "sexo", "sobrevivio")
arrange <- ggarrange(g1, g2, nrow = 1, ncol = 2)
arrange <- ggarrange(g1, g2, nrow = 1, ncol = 2, common.legend = TRUE, legend = "bottom")
annotate_figure(arrange,
top = text_grob("AnÃ¡lisis sobrevivio vs resto de cualitativas"))
